{"dependencies":[{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}},{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":32,"index":79}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _socketIoClient = require(_dependencyMap[0], \"socket.io-client\");\n  var _storage = require(_dependencyMap[1], \"./storage\");\n  var storage = _interopDefault(_storage);\n  const SOCKET_URL = process.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n  class SocketService {\n    socket = null;\n    listeners = new Map();\n    async connect() {\n      if (this.socket?.connected) return;\n      const token = await storage.default.getItem('authToken');\n      if (!token) {\n        console.log('No auth token found');\n        return;\n      }\n      this.socket = (0, _socketIoClient.io)(SOCKET_URL, {\n        transports: ['websocket', 'polling'],\n        reconnection: true,\n        reconnectionDelay: 1000,\n        reconnectionAttempts: 5\n      });\n      this.socket.on('connect', () => {\n        console.log('Socket connected');\n        this.socket?.emit('authenticate', {\n          token\n        });\n      });\n      this.socket.on('authenticated', data => {\n        console.log('Socket authenticated:', data);\n      });\n      this.socket.on('connect_error', error => {\n        console.error('Socket connection error:', error);\n      });\n      this.socket.on('disconnect', () => {\n        console.log('Socket disconnected');\n      });\n    }\n    disconnect() {\n      if (this.socket) {\n        this.socket.disconnect();\n        this.socket = null;\n        this.listeners.clear();\n      }\n    }\n    joinCommunity() {\n      if (!this.socket) return;\n      this.socket.emit('join_community', {});\n    }\n    sendMessage(message) {\n      if (!this.socket) return;\n      this.socket.emit('send_message', {\n        message\n      });\n    }\n    onNewMessage(callback) {\n      if (!this.socket) return () => {};\n      this.socket.on('new_message', callback);\n\n      // Store listener for cleanup\n      if (!this.listeners.has('new_message')) {\n        this.listeners.set('new_message', []);\n      }\n      this.listeners.get('new_message')?.push(callback);\n      return () => {\n        this.socket?.off('new_message', callback);\n      };\n    }\n    onUserJoined(callback) {\n      if (!this.socket) return () => {};\n      this.socket.on('user_joined', callback);\n      return () => {\n        this.socket?.off('user_joined', callback);\n      };\n    }\n    emitTyping() {\n      if (!this.socket) return;\n      this.socket.emit('typing', {});\n    }\n    isConnected() {\n      return this.socket?.connected || false;\n    }\n  }\n  const socketService = new SocketService();\n});","lineCount":100,"map":[[12,2,96,0,"Object"],[12,8,96,0],[12,9,96,0,"defineProperty"],[12,23,96,0],[12,24,96,0,"exports"],[12,31,96,0],[13,4,96,0,"enumerable"],[13,14,96,0],[14,4,96,0,"get"],[14,7,96,0],[14,18,96,0,"get"],[14,19,96,0],[15,6,96,0],[15,13,96,0,"socketService"],[15,26,96,0],[16,4,96,0],[17,2,96,0],[18,2,1,0],[18,6,1,0,"_socketIoClient"],[18,21,1,0],[18,24,1,0,"require"],[18,31,1,0],[18,32,1,0,"_dependencyMap"],[18,46,1,0],[19,2,2,0],[19,6,2,0,"_storage"],[19,14,2,0],[19,17,2,0,"require"],[19,24,2,0],[19,25,2,0,"_dependencyMap"],[19,39,2,0],[20,2,2,0],[20,6,2,0,"storage"],[20,13,2,0],[20,16,2,0,"_interopDefault"],[20,31,2,0],[20,32,2,0,"_storage"],[20,40,2,0],[21,2,4,0],[21,8,4,6,"SOCKET_URL"],[21,18,4,16],[21,21,4,19,"process"],[21,28,4,26],[21,29,4,27,"env"],[21,32,4,30],[21,33,4,31,"EXPO_PUBLIC_BACKEND_URL"],[21,56,4,54],[21,60,4,58],[21,83,4,81],[22,2,6,0],[22,8,6,6,"SocketService"],[22,21,6,19],[22,22,6,20],[23,4,7,10,"socket"],[23,10,7,16],[23,13,7,34],[23,17,7,38],[24,4,8,10,"listeners"],[24,13,8,19],[24,16,8,47],[24,20,8,51,"Map"],[24,23,8,54],[24,24,8,55],[24,25,8,56],[25,4,10,2],[25,10,10,8,"connect"],[25,17,10,15,"connect"],[25,18,10,15],[25,20,10,18],[26,6,11,4],[26,10,11,8],[26,14,11,12],[26,15,11,13,"socket"],[26,21,11,19],[26,23,11,21,"connected"],[26,32,11,30],[26,34,11,32],[27,6,13,4],[27,12,13,10,"token"],[27,17,13,15],[27,20,13,18],[27,26,13,24,"storage"],[27,33,13,31],[27,34,13,31,"default"],[27,41,13,31],[27,42,13,32,"getItem"],[27,49,13,39],[27,50,13,40],[27,61,13,51],[27,62,13,52],[28,6,14,4],[28,10,14,8],[28,11,14,9,"token"],[28,16,14,14],[28,18,14,16],[29,8,15,6,"console"],[29,15,15,13],[29,16,15,14,"log"],[29,19,15,17],[29,20,15,18],[29,41,15,39],[29,42,15,40],[30,8,16,6],[31,6,17,4],[32,6,19,4],[32,10,19,8],[32,11,19,9,"socket"],[32,17,19,15],[32,20,19,18],[32,24,19,18,"io"],[32,39,19,20],[32,40,19,20,"io"],[32,42,19,20],[32,44,19,21,"SOCKET_URL"],[32,54,19,31],[32,56,19,33],[33,8,20,6,"transports"],[33,18,20,16],[33,20,20,18],[33,21,20,19],[33,32,20,30],[33,34,20,32],[33,43,20,41],[33,44,20,42],[34,8,21,6,"reconnection"],[34,20,21,18],[34,22,21,20],[34,26,21,24],[35,8,22,6,"reconnectionDelay"],[35,25,22,23],[35,27,22,25],[35,31,22,29],[36,8,23,6,"reconnectionAttempts"],[36,28,23,26],[36,30,23,28],[37,6,24,4],[37,7,24,5],[37,8,24,6],[38,6,26,4],[38,10,26,8],[38,11,26,9,"socket"],[38,17,26,15],[38,18,26,16,"on"],[38,20,26,18],[38,21,26,19],[38,30,26,28],[38,32,26,30],[38,38,26,36],[39,8,27,6,"console"],[39,15,27,13],[39,16,27,14,"log"],[39,19,27,17],[39,20,27,18],[39,38,27,36],[39,39,27,37],[40,8,28,6],[40,12,28,10],[40,13,28,11,"socket"],[40,19,28,17],[40,21,28,19,"emit"],[40,25,28,23],[40,26,28,24],[40,40,28,38],[40,42,28,40],[41,10,28,42,"token"],[42,8,28,48],[42,9,28,49],[42,10,28,50],[43,6,29,4],[43,7,29,5],[43,8,29,6],[44,6,31,4],[44,10,31,8],[44,11,31,9,"socket"],[44,17,31,15],[44,18,31,16,"on"],[44,20,31,18],[44,21,31,19],[44,36,31,34],[44,38,31,37,"data"],[44,42,31,41],[44,46,31,46],[45,8,32,6,"console"],[45,15,32,13],[45,16,32,14,"log"],[45,19,32,17],[45,20,32,18],[45,43,32,41],[45,45,32,43,"data"],[45,49,32,47],[45,50,32,48],[46,6,33,4],[46,7,33,5],[46,8,33,6],[47,6,35,4],[47,10,35,8],[47,11,35,9,"socket"],[47,17,35,15],[47,18,35,16,"on"],[47,20,35,18],[47,21,35,19],[47,36,35,34],[47,38,35,37,"error"],[47,43,35,42],[47,47,35,47],[48,8,36,6,"console"],[48,15,36,13],[48,16,36,14,"error"],[48,21,36,19],[48,22,36,20],[48,48,36,46],[48,50,36,48,"error"],[48,55,36,53],[48,56,36,54],[49,6,37,4],[49,7,37,5],[49,8,37,6],[50,6,39,4],[50,10,39,8],[50,11,39,9,"socket"],[50,17,39,15],[50,18,39,16,"on"],[50,20,39,18],[50,21,39,19],[50,33,39,31],[50,35,39,33],[50,41,39,39],[51,8,40,6,"console"],[51,15,40,13],[51,16,40,14,"log"],[51,19,40,17],[51,20,40,18],[51,41,40,39],[51,42,40,40],[52,6,41,4],[52,7,41,5],[52,8,41,6],[53,4,42,2],[54,4,44,2,"disconnect"],[54,14,44,12,"disconnect"],[54,15,44,12],[54,17,44,15],[55,6,45,4],[55,10,45,8],[55,14,45,12],[55,15,45,13,"socket"],[55,21,45,19],[55,23,45,21],[56,8,46,6],[56,12,46,10],[56,13,46,11,"socket"],[56,19,46,17],[56,20,46,18,"disconnect"],[56,30,46,28],[56,31,46,29],[56,32,46,30],[57,8,47,6],[57,12,47,10],[57,13,47,11,"socket"],[57,19,47,17],[57,22,47,20],[57,26,47,24],[58,8,48,6],[58,12,48,10],[58,13,48,11,"listeners"],[58,22,48,20],[58,23,48,21,"clear"],[58,28,48,26],[58,29,48,27],[58,30,48,28],[59,6,49,4],[60,4,50,2],[61,4,52,2,"joinCommunity"],[61,17,52,15,"joinCommunity"],[61,18,52,15],[61,20,52,18],[62,6,53,4],[62,10,53,8],[62,11,53,9],[62,15,53,13],[62,16,53,14,"socket"],[62,22,53,20],[62,24,53,22],[63,6,54,4],[63,10,54,8],[63,11,54,9,"socket"],[63,17,54,15],[63,18,54,16,"emit"],[63,22,54,20],[63,23,54,21],[63,39,54,37],[63,41,54,39],[63,42,54,40],[63,43,54,41],[63,44,54,42],[64,4,55,2],[65,4,57,2,"sendMessage"],[65,15,57,13,"sendMessage"],[65,16,57,14,"message"],[65,23,57,29],[65,25,57,31],[66,6,58,4],[66,10,58,8],[66,11,58,9],[66,15,58,13],[66,16,58,14,"socket"],[66,22,58,20],[66,24,58,22],[67,6,59,4],[67,10,59,8],[67,11,59,9,"socket"],[67,17,59,15],[67,18,59,16,"emit"],[67,22,59,20],[67,23,59,21],[67,37,59,35],[67,39,59,37],[68,8,59,39,"message"],[69,6,59,47],[69,7,59,48],[69,8,59,49],[70,4,60,2],[71,4,62,2,"onNewMessage"],[71,16,62,14,"onNewMessage"],[71,17,62,15,"callback"],[71,25,62,44],[71,27,62,46],[72,6,63,4],[72,10,63,8],[72,11,63,9],[72,15,63,13],[72,16,63,14,"socket"],[72,22,63,20],[72,24,63,22],[72,31,63,29],[72,37,63,35],[72,38,63,36],[72,39,63,37],[73,6,65,4],[73,10,65,8],[73,11,65,9,"socket"],[73,17,65,15],[73,18,65,16,"on"],[73,20,65,18],[73,21,65,19],[73,34,65,32],[73,36,65,34,"callback"],[73,44,65,42],[73,45,65,43],[75,6,67,4],[76,6,68,4],[76,10,68,8],[76,11,68,9],[76,15,68,13],[76,16,68,14,"listeners"],[76,25,68,23],[76,26,68,24,"has"],[76,29,68,27],[76,30,68,28],[76,43,68,41],[76,44,68,42],[76,46,68,44],[77,8,69,6],[77,12,69,10],[77,13,69,11,"listeners"],[77,22,69,20],[77,23,69,21,"set"],[77,26,69,24],[77,27,69,25],[77,40,69,38],[77,42,69,40],[77,44,69,42],[77,45,69,43],[78,6,70,4],[79,6,71,4],[79,10,71,8],[79,11,71,9,"listeners"],[79,20,71,18],[79,21,71,19,"get"],[79,24,71,22],[79,25,71,23],[79,38,71,36],[79,39,71,37],[79,41,71,39,"push"],[79,45,71,43],[79,46,71,44,"callback"],[79,54,71,52],[79,55,71,53],[80,6,73,4],[80,13,73,11],[80,19,73,17],[81,8,74,6],[81,12,74,10],[81,13,74,11,"socket"],[81,19,74,17],[81,21,74,19,"off"],[81,24,74,22],[81,25,74,23],[81,38,74,36],[81,40,74,38,"callback"],[81,48,74,46],[81,49,74,47],[82,6,75,4],[82,7,75,5],[83,4,76,2],[84,4,78,2,"onUserJoined"],[84,16,78,14,"onUserJoined"],[84,17,78,15,"callback"],[84,25,78,44],[84,27,78,46],[85,6,79,4],[85,10,79,8],[85,11,79,9],[85,15,79,13],[85,16,79,14,"socket"],[85,22,79,20],[85,24,79,22],[85,31,79,29],[85,37,79,35],[85,38,79,36],[85,39,79,37],[86,6,80,4],[86,10,80,8],[86,11,80,9,"socket"],[86,17,80,15],[86,18,80,16,"on"],[86,20,80,18],[86,21,80,19],[86,34,80,32],[86,36,80,34,"callback"],[86,44,80,42],[86,45,80,43],[87,6,81,4],[87,13,81,11],[87,19,81,17],[88,8,82,6],[88,12,82,10],[88,13,82,11,"socket"],[88,19,82,17],[88,21,82,19,"off"],[88,24,82,22],[88,25,82,23],[88,38,82,36],[88,40,82,38,"callback"],[88,48,82,46],[88,49,82,47],[89,6,83,4],[89,7,83,5],[90,4,84,2],[91,4,86,2,"emitTyping"],[91,14,86,12,"emitTyping"],[91,15,86,12],[91,17,86,15],[92,6,87,4],[92,10,87,8],[92,11,87,9],[92,15,87,13],[92,16,87,14,"socket"],[92,22,87,20],[92,24,87,22],[93,6,88,4],[93,10,88,8],[93,11,88,9,"socket"],[93,17,88,15],[93,18,88,16,"emit"],[93,22,88,20],[93,23,88,21],[93,31,88,29],[93,33,88,31],[93,34,88,32],[93,35,88,33],[93,36,88,34],[94,4,89,2],[95,4,91,2,"isConnected"],[95,15,91,13,"isConnected"],[95,16,91,13],[95,18,91,25],[96,6,92,4],[96,13,92,11],[96,17,92,15],[96,18,92,16,"socket"],[96,24,92,22],[96,26,92,24,"connected"],[96,35,92,33],[96,39,92,37],[96,44,92,42],[97,4,93,2],[98,2,94,0],[99,2,96,7],[99,8,96,13,"socketService"],[99,21,96,26],[99,24,96,29],[99,28,96,33,"SocketService"],[99,41,96,46],[99,42,96,47],[99,43,96,48],[100,0,96,49],[100,3]],"functionMap":{"names":["<global>","SocketService","SocketService#connect","on$argument_1","SocketService#disconnect","SocketService#joinCommunity","SocketService#sendMessage","SocketService#onNewMessage","<anonymous>","SocketService#onUserJoined","SocketService#emitTyping","SocketService#isConnected"],"mappings":"AAA;ACK;ECI;8BCgB;KDG;oCCE;KDE;oCCE;KDE;iCCE;KDE;GDC;EGE;GHM;EIE;GJG;EKE;GLG;EME;6BCC,QD;WCU;KDE;GNC;EQE;6BDC,QC;WDE;KCE;GRC;ESE;GTG;EUE;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}