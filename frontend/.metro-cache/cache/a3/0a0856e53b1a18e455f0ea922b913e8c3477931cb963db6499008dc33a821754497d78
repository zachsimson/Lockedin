{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":49,"index":96}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _socketIoClient = require(_dependencyMap[1], \"socket.io-client\");\n  var _expoSecureStore = require(_dependencyMap[2], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  const SOCKET_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n  class SocketService {\n    socket = null;\n    listeners = new Map();\n    async connect() {\n      if (this.socket?.connected) return;\n      const token = await SecureStore.getItemAsync('authToken');\n      if (!token) {\n        console.log('No auth token found');\n        return;\n      }\n      this.socket = (0, _socketIoClient.io)(SOCKET_URL, {\n        transports: ['websocket', 'polling'],\n        reconnection: true,\n        reconnectionDelay: 1000,\n        reconnectionAttempts: 5\n      });\n      this.socket.on('connect', () => {\n        console.log('Socket connected');\n        this.socket?.emit('authenticate', {\n          token\n        });\n      });\n      this.socket.on('authenticated', data => {\n        console.log('Socket authenticated:', data);\n      });\n      this.socket.on('connect_error', error => {\n        console.error('Socket connection error:', error);\n      });\n      this.socket.on('disconnect', () => {\n        console.log('Socket disconnected');\n      });\n    }\n    disconnect() {\n      if (this.socket) {\n        this.socket.disconnect();\n        this.socket = null;\n        this.listeners.clear();\n      }\n    }\n    joinCommunity() {\n      if (!this.socket) return;\n      this.socket.emit('join_community', {});\n    }\n    sendMessage(message) {\n      if (!this.socket) return;\n      this.socket.emit('send_message', {\n        message\n      });\n    }\n    onNewMessage(callback) {\n      if (!this.socket) return () => {};\n      this.socket.on('new_message', callback);\n\n      // Store listener for cleanup\n      if (!this.listeners.has('new_message')) {\n        this.listeners.set('new_message', []);\n      }\n      this.listeners.get('new_message')?.push(callback);\n      return () => {\n        this.socket?.off('new_message', callback);\n      };\n    }\n    onUserJoined(callback) {\n      if (!this.socket) return () => {};\n      this.socket.on('user_joined', callback);\n      return () => {\n        this.socket?.off('user_joined', callback);\n      };\n    }\n    emitTyping() {\n      if (!this.socket) return;\n      this.socket.emit('typing', {});\n    }\n    isConnected() {\n      return this.socket?.connected || false;\n    }\n  }\n  const socketService = new SocketService();\n});","lineCount":111,"map":[[22,2,96,0,"Object"],[22,8,96,0],[22,9,96,0,"defineProperty"],[22,23,96,0],[22,24,96,0,"exports"],[22,31,96,0],[23,4,96,0,"enumerable"],[23,14,96,0],[24,4,96,0,"get"],[24,7,96,0],[24,18,96,0,"get"],[24,19,96,0],[25,6,96,0],[25,13,96,0,"socketService"],[25,26,96,0],[26,4,96,0],[27,2,96,0],[28,2,96,49],[28,6,96,49,"_expoVirtualEnv"],[28,21,96,49],[28,24,96,49,"require"],[28,31,96,49],[28,32,96,49,"_dependencyMap"],[28,46,96,49],[29,2,1,0],[29,6,1,0,"_socketIoClient"],[29,21,1,0],[29,24,1,0,"require"],[29,31,1,0],[29,32,1,0,"_dependencyMap"],[29,46,1,0],[30,2,2,0],[30,6,2,0,"_expoSecureStore"],[30,22,2,0],[30,25,2,0,"require"],[30,32,2,0],[30,33,2,0,"_dependencyMap"],[30,47,2,0],[31,2,2,0],[31,6,2,0,"SecureStore"],[31,17,2,0],[31,20,2,0,"_interopNamespace"],[31,37,2,0],[31,38,2,0,"_expoSecureStore"],[31,54,2,0],[32,2,4,0],[32,8,4,6,"SOCKET_URL"],[32,18,4,16],[32,21,4,19,"_expoVirtualEnv"],[32,36,4,19],[32,37,4,19,"env"],[32,40,4,19],[32,41,4,19,"EXPO_PUBLIC_BACKEND_URL"],[32,64,4,19],[32,68,4,58],[32,91,4,81],[33,2,6,0],[33,8,6,6,"SocketService"],[33,21,6,19],[33,22,6,20],[34,4,7,10,"socket"],[34,10,7,16],[34,13,7,34],[34,17,7,38],[35,4,8,10,"listeners"],[35,13,8,19],[35,16,8,47],[35,20,8,51,"Map"],[35,23,8,54],[35,24,8,55],[35,25,8,56],[36,4,10,2],[36,10,10,8,"connect"],[36,17,10,15,"connect"],[36,18,10,15],[36,20,10,18],[37,6,11,4],[37,10,11,8],[37,14,11,12],[37,15,11,13,"socket"],[37,21,11,19],[37,23,11,21,"connected"],[37,32,11,30],[37,34,11,32],[38,6,13,4],[38,12,13,10,"token"],[38,17,13,15],[38,20,13,18],[38,26,13,24,"SecureStore"],[38,37,13,35],[38,38,13,36,"getItemAsync"],[38,50,13,48],[38,51,13,49],[38,62,13,60],[38,63,13,61],[39,6,14,4],[39,10,14,8],[39,11,14,9,"token"],[39,16,14,14],[39,18,14,16],[40,8,15,6,"console"],[40,15,15,13],[40,16,15,14,"log"],[40,19,15,17],[40,20,15,18],[40,41,15,39],[40,42,15,40],[41,8,16,6],[42,6,17,4],[43,6,19,4],[43,10,19,8],[43,11,19,9,"socket"],[43,17,19,15],[43,20,19,18],[43,24,19,18,"io"],[43,39,19,20],[43,40,19,20,"io"],[43,42,19,20],[43,44,19,21,"SOCKET_URL"],[43,54,19,31],[43,56,19,33],[44,8,20,6,"transports"],[44,18,20,16],[44,20,20,18],[44,21,20,19],[44,32,20,30],[44,34,20,32],[44,43,20,41],[44,44,20,42],[45,8,21,6,"reconnection"],[45,20,21,18],[45,22,21,20],[45,26,21,24],[46,8,22,6,"reconnectionDelay"],[46,25,22,23],[46,27,22,25],[46,31,22,29],[47,8,23,6,"reconnectionAttempts"],[47,28,23,26],[47,30,23,28],[48,6,24,4],[48,7,24,5],[48,8,24,6],[49,6,26,4],[49,10,26,8],[49,11,26,9,"socket"],[49,17,26,15],[49,18,26,16,"on"],[49,20,26,18],[49,21,26,19],[49,30,26,28],[49,32,26,30],[49,38,26,36],[50,8,27,6,"console"],[50,15,27,13],[50,16,27,14,"log"],[50,19,27,17],[50,20,27,18],[50,38,27,36],[50,39,27,37],[51,8,28,6],[51,12,28,10],[51,13,28,11,"socket"],[51,19,28,17],[51,21,28,19,"emit"],[51,25,28,23],[51,26,28,24],[51,40,28,38],[51,42,28,40],[52,10,28,42,"token"],[53,8,28,48],[53,9,28,49],[53,10,28,50],[54,6,29,4],[54,7,29,5],[54,8,29,6],[55,6,31,4],[55,10,31,8],[55,11,31,9,"socket"],[55,17,31,15],[55,18,31,16,"on"],[55,20,31,18],[55,21,31,19],[55,36,31,34],[55,38,31,37,"data"],[55,42,31,41],[55,46,31,46],[56,8,32,6,"console"],[56,15,32,13],[56,16,32,14,"log"],[56,19,32,17],[56,20,32,18],[56,43,32,41],[56,45,32,43,"data"],[56,49,32,47],[56,50,32,48],[57,6,33,4],[57,7,33,5],[57,8,33,6],[58,6,35,4],[58,10,35,8],[58,11,35,9,"socket"],[58,17,35,15],[58,18,35,16,"on"],[58,20,35,18],[58,21,35,19],[58,36,35,34],[58,38,35,37,"error"],[58,43,35,42],[58,47,35,47],[59,8,36,6,"console"],[59,15,36,13],[59,16,36,14,"error"],[59,21,36,19],[59,22,36,20],[59,48,36,46],[59,50,36,48,"error"],[59,55,36,53],[59,56,36,54],[60,6,37,4],[60,7,37,5],[60,8,37,6],[61,6,39,4],[61,10,39,8],[61,11,39,9,"socket"],[61,17,39,15],[61,18,39,16,"on"],[61,20,39,18],[61,21,39,19],[61,33,39,31],[61,35,39,33],[61,41,39,39],[62,8,40,6,"console"],[62,15,40,13],[62,16,40,14,"log"],[62,19,40,17],[62,20,40,18],[62,41,40,39],[62,42,40,40],[63,6,41,4],[63,7,41,5],[63,8,41,6],[64,4,42,2],[65,4,44,2,"disconnect"],[65,14,44,12,"disconnect"],[65,15,44,12],[65,17,44,15],[66,6,45,4],[66,10,45,8],[66,14,45,12],[66,15,45,13,"socket"],[66,21,45,19],[66,23,45,21],[67,8,46,6],[67,12,46,10],[67,13,46,11,"socket"],[67,19,46,17],[67,20,46,18,"disconnect"],[67,30,46,28],[67,31,46,29],[67,32,46,30],[68,8,47,6],[68,12,47,10],[68,13,47,11,"socket"],[68,19,47,17],[68,22,47,20],[68,26,47,24],[69,8,48,6],[69,12,48,10],[69,13,48,11,"listeners"],[69,22,48,20],[69,23,48,21,"clear"],[69,28,48,26],[69,29,48,27],[69,30,48,28],[70,6,49,4],[71,4,50,2],[72,4,52,2,"joinCommunity"],[72,17,52,15,"joinCommunity"],[72,18,52,15],[72,20,52,18],[73,6,53,4],[73,10,53,8],[73,11,53,9],[73,15,53,13],[73,16,53,14,"socket"],[73,22,53,20],[73,24,53,22],[74,6,54,4],[74,10,54,8],[74,11,54,9,"socket"],[74,17,54,15],[74,18,54,16,"emit"],[74,22,54,20],[74,23,54,21],[74,39,54,37],[74,41,54,39],[74,42,54,40],[74,43,54,41],[74,44,54,42],[75,4,55,2],[76,4,57,2,"sendMessage"],[76,15,57,13,"sendMessage"],[76,16,57,14,"message"],[76,23,57,29],[76,25,57,31],[77,6,58,4],[77,10,58,8],[77,11,58,9],[77,15,58,13],[77,16,58,14,"socket"],[77,22,58,20],[77,24,58,22],[78,6,59,4],[78,10,59,8],[78,11,59,9,"socket"],[78,17,59,15],[78,18,59,16,"emit"],[78,22,59,20],[78,23,59,21],[78,37,59,35],[78,39,59,37],[79,8,59,39,"message"],[80,6,59,47],[80,7,59,48],[80,8,59,49],[81,4,60,2],[82,4,62,2,"onNewMessage"],[82,16,62,14,"onNewMessage"],[82,17,62,15,"callback"],[82,25,62,44],[82,27,62,46],[83,6,63,4],[83,10,63,8],[83,11,63,9],[83,15,63,13],[83,16,63,14,"socket"],[83,22,63,20],[83,24,63,22],[83,31,63,29],[83,37,63,35],[83,38,63,36],[83,39,63,37],[84,6,65,4],[84,10,65,8],[84,11,65,9,"socket"],[84,17,65,15],[84,18,65,16,"on"],[84,20,65,18],[84,21,65,19],[84,34,65,32],[84,36,65,34,"callback"],[84,44,65,42],[84,45,65,43],[86,6,67,4],[87,6,68,4],[87,10,68,8],[87,11,68,9],[87,15,68,13],[87,16,68,14,"listeners"],[87,25,68,23],[87,26,68,24,"has"],[87,29,68,27],[87,30,68,28],[87,43,68,41],[87,44,68,42],[87,46,68,44],[88,8,69,6],[88,12,69,10],[88,13,69,11,"listeners"],[88,22,69,20],[88,23,69,21,"set"],[88,26,69,24],[88,27,69,25],[88,40,69,38],[88,42,69,40],[88,44,69,42],[88,45,69,43],[89,6,70,4],[90,6,71,4],[90,10,71,8],[90,11,71,9,"listeners"],[90,20,71,18],[90,21,71,19,"get"],[90,24,71,22],[90,25,71,23],[90,38,71,36],[90,39,71,37],[90,41,71,39,"push"],[90,45,71,43],[90,46,71,44,"callback"],[90,54,71,52],[90,55,71,53],[91,6,73,4],[91,13,73,11],[91,19,73,17],[92,8,74,6],[92,12,74,10],[92,13,74,11,"socket"],[92,19,74,17],[92,21,74,19,"off"],[92,24,74,22],[92,25,74,23],[92,38,74,36],[92,40,74,38,"callback"],[92,48,74,46],[92,49,74,47],[93,6,75,4],[93,7,75,5],[94,4,76,2],[95,4,78,2,"onUserJoined"],[95,16,78,14,"onUserJoined"],[95,17,78,15,"callback"],[95,25,78,44],[95,27,78,46],[96,6,79,4],[96,10,79,8],[96,11,79,9],[96,15,79,13],[96,16,79,14,"socket"],[96,22,79,20],[96,24,79,22],[96,31,79,29],[96,37,79,35],[96,38,79,36],[96,39,79,37],[97,6,80,4],[97,10,80,8],[97,11,80,9,"socket"],[97,17,80,15],[97,18,80,16,"on"],[97,20,80,18],[97,21,80,19],[97,34,80,32],[97,36,80,34,"callback"],[97,44,80,42],[97,45,80,43],[98,6,81,4],[98,13,81,11],[98,19,81,17],[99,8,82,6],[99,12,82,10],[99,13,82,11,"socket"],[99,19,82,17],[99,21,82,19,"off"],[99,24,82,22],[99,25,82,23],[99,38,82,36],[99,40,82,38,"callback"],[99,48,82,46],[99,49,82,47],[100,6,83,4],[100,7,83,5],[101,4,84,2],[102,4,86,2,"emitTyping"],[102,14,86,12,"emitTyping"],[102,15,86,12],[102,17,86,15],[103,6,87,4],[103,10,87,8],[103,11,87,9],[103,15,87,13],[103,16,87,14,"socket"],[103,22,87,20],[103,24,87,22],[104,6,88,4],[104,10,88,8],[104,11,88,9,"socket"],[104,17,88,15],[104,18,88,16,"emit"],[104,22,88,20],[104,23,88,21],[104,31,88,29],[104,33,88,31],[104,34,88,32],[104,35,88,33],[104,36,88,34],[105,4,89,2],[106,4,91,2,"isConnected"],[106,15,91,13,"isConnected"],[106,16,91,13],[106,18,91,25],[107,6,92,4],[107,13,92,11],[107,17,92,15],[107,18,92,16,"socket"],[107,24,92,22],[107,26,92,24,"connected"],[107,35,92,33],[107,39,92,37],[107,44,92,42],[108,4,93,2],[109,2,94,0],[110,2,96,7],[110,8,96,13,"socketService"],[110,21,96,26],[110,24,96,29],[110,28,96,33,"SocketService"],[110,41,96,46],[110,42,96,47],[110,43,96,48],[111,0,96,49],[111,3]],"functionMap":{"names":["<global>","SocketService","SocketService#connect","on$argument_1","SocketService#disconnect","SocketService#joinCommunity","SocketService#sendMessage","SocketService#onNewMessage","<anonymous>","SocketService#onUserJoined","SocketService#emitTyping","SocketService#isConnected"],"mappings":"AAA;ACK;ECI;8BCgB;KDG;oCCE;KDE;oCCE;KDE;iCCE;KDE;GDC;EGE;GHM;EIE;GJG;EKE;GLG;EME;6BCC,QD;WCU;KDE;GNC;EQE;6BDC,QC;WDE;KCE;GRC;ESE;GTG;EUE;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}