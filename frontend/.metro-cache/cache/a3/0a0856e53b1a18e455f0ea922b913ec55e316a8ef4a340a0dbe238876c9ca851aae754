{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _socketIoClient = require(_dependencyMap[1], \"socket.io-client\");\n  const SOCKET_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n  class SocketService {\n    socket = null;\n    listeners = new Map();\n    async connect() {\n      if (this.socket?.connected) return;\n      const token = await SecureStore.getItemAsync('authToken');\n      if (!token) {\n        console.log('No auth token found');\n        return;\n      }\n      this.socket = (0, _socketIoClient.io)(SOCKET_URL, {\n        transports: ['websocket', 'polling'],\n        reconnection: true,\n        reconnectionDelay: 1000,\n        reconnectionAttempts: 5\n      });\n      this.socket.on('connect', () => {\n        console.log('Socket connected');\n        this.socket?.emit('authenticate', {\n          token\n        });\n      });\n      this.socket.on('authenticated', data => {\n        console.log('Socket authenticated:', data);\n      });\n      this.socket.on('connect_error', error => {\n        console.error('Socket connection error:', error);\n      });\n      this.socket.on('disconnect', () => {\n        console.log('Socket disconnected');\n      });\n    }\n    disconnect() {\n      if (this.socket) {\n        this.socket.disconnect();\n        this.socket = null;\n        this.listeners.clear();\n      }\n    }\n    joinCommunity() {\n      if (!this.socket) return;\n      this.socket.emit('join_community', {});\n    }\n    sendMessage(message) {\n      if (!this.socket) return;\n      this.socket.emit('send_message', {\n        message\n      });\n    }\n    onNewMessage(callback) {\n      if (!this.socket) return () => {};\n      this.socket.on('new_message', callback);\n\n      // Store listener for cleanup\n      if (!this.listeners.has('new_message')) {\n        this.listeners.set('new_message', []);\n      }\n      this.listeners.get('new_message')?.push(callback);\n      return () => {\n        this.socket?.off('new_message', callback);\n      };\n    }\n    onUserJoined(callback) {\n      if (!this.socket) return () => {};\n      this.socket.on('user_joined', callback);\n      return () => {\n        this.socket?.off('user_joined', callback);\n      };\n    }\n    emitTyping() {\n      if (!this.socket) return;\n      this.socket.emit('typing', {});\n    }\n    isConnected() {\n      return this.socket?.connected || false;\n    }\n  }\n  const socketService = new SocketService();\n});","lineCount":94,"map":[[7,2,96,0,"Object"],[7,8,96,0],[7,9,96,0,"defineProperty"],[7,23,96,0],[7,24,96,0,"exports"],[7,31,96,0],[8,4,96,0,"enumerable"],[8,14,96,0],[9,4,96,0,"get"],[9,7,96,0],[9,18,96,0,"get"],[9,19,96,0],[10,6,96,0],[10,13,96,0,"socketService"],[10,26,96,0],[11,4,96,0],[12,2,96,0],[13,2,96,49],[13,6,96,49,"_expoVirtualEnv"],[13,21,96,49],[13,24,96,49,"require"],[13,31,96,49],[13,32,96,49,"_dependencyMap"],[13,46,96,49],[14,2,1,0],[14,6,1,0,"_socketIoClient"],[14,21,1,0],[14,24,1,0,"require"],[14,31,1,0],[14,32,1,0,"_dependencyMap"],[14,46,1,0],[15,2,4,0],[15,8,4,6,"SOCKET_URL"],[15,18,4,16],[15,21,4,19,"_expoVirtualEnv"],[15,36,4,19],[15,37,4,19,"env"],[15,40,4,19],[15,41,4,19,"EXPO_PUBLIC_BACKEND_URL"],[15,64,4,19],[15,68,4,58],[15,91,4,81],[16,2,6,0],[16,8,6,6,"SocketService"],[16,21,6,19],[16,22,6,20],[17,4,7,10,"socket"],[17,10,7,16],[17,13,7,34],[17,17,7,38],[18,4,8,10,"listeners"],[18,13,8,19],[18,16,8,47],[18,20,8,51,"Map"],[18,23,8,54],[18,24,8,55],[18,25,8,56],[19,4,10,2],[19,10,10,8,"connect"],[19,17,10,15,"connect"],[19,18,10,15],[19,20,10,18],[20,6,11,4],[20,10,11,8],[20,14,11,12],[20,15,11,13,"socket"],[20,21,11,19],[20,23,11,21,"connected"],[20,32,11,30],[20,34,11,32],[21,6,13,4],[21,12,13,10,"token"],[21,17,13,15],[21,20,13,18],[21,26,13,24,"SecureStore"],[21,37,13,35],[21,38,13,36,"getItemAsync"],[21,50,13,48],[21,51,13,49],[21,62,13,60],[21,63,13,61],[22,6,14,4],[22,10,14,8],[22,11,14,9,"token"],[22,16,14,14],[22,18,14,16],[23,8,15,6,"console"],[23,15,15,13],[23,16,15,14,"log"],[23,19,15,17],[23,20,15,18],[23,41,15,39],[23,42,15,40],[24,8,16,6],[25,6,17,4],[26,6,19,4],[26,10,19,8],[26,11,19,9,"socket"],[26,17,19,15],[26,20,19,18],[26,24,19,18,"io"],[26,39,19,20],[26,40,19,20,"io"],[26,42,19,20],[26,44,19,21,"SOCKET_URL"],[26,54,19,31],[26,56,19,33],[27,8,20,6,"transports"],[27,18,20,16],[27,20,20,18],[27,21,20,19],[27,32,20,30],[27,34,20,32],[27,43,20,41],[27,44,20,42],[28,8,21,6,"reconnection"],[28,20,21,18],[28,22,21,20],[28,26,21,24],[29,8,22,6,"reconnectionDelay"],[29,25,22,23],[29,27,22,25],[29,31,22,29],[30,8,23,6,"reconnectionAttempts"],[30,28,23,26],[30,30,23,28],[31,6,24,4],[31,7,24,5],[31,8,24,6],[32,6,26,4],[32,10,26,8],[32,11,26,9,"socket"],[32,17,26,15],[32,18,26,16,"on"],[32,20,26,18],[32,21,26,19],[32,30,26,28],[32,32,26,30],[32,38,26,36],[33,8,27,6,"console"],[33,15,27,13],[33,16,27,14,"log"],[33,19,27,17],[33,20,27,18],[33,38,27,36],[33,39,27,37],[34,8,28,6],[34,12,28,10],[34,13,28,11,"socket"],[34,19,28,17],[34,21,28,19,"emit"],[34,25,28,23],[34,26,28,24],[34,40,28,38],[34,42,28,40],[35,10,28,42,"token"],[36,8,28,48],[36,9,28,49],[36,10,28,50],[37,6,29,4],[37,7,29,5],[37,8,29,6],[38,6,31,4],[38,10,31,8],[38,11,31,9,"socket"],[38,17,31,15],[38,18,31,16,"on"],[38,20,31,18],[38,21,31,19],[38,36,31,34],[38,38,31,37,"data"],[38,42,31,41],[38,46,31,46],[39,8,32,6,"console"],[39,15,32,13],[39,16,32,14,"log"],[39,19,32,17],[39,20,32,18],[39,43,32,41],[39,45,32,43,"data"],[39,49,32,47],[39,50,32,48],[40,6,33,4],[40,7,33,5],[40,8,33,6],[41,6,35,4],[41,10,35,8],[41,11,35,9,"socket"],[41,17,35,15],[41,18,35,16,"on"],[41,20,35,18],[41,21,35,19],[41,36,35,34],[41,38,35,37,"error"],[41,43,35,42],[41,47,35,47],[42,8,36,6,"console"],[42,15,36,13],[42,16,36,14,"error"],[42,21,36,19],[42,22,36,20],[42,48,36,46],[42,50,36,48,"error"],[42,55,36,53],[42,56,36,54],[43,6,37,4],[43,7,37,5],[43,8,37,6],[44,6,39,4],[44,10,39,8],[44,11,39,9,"socket"],[44,17,39,15],[44,18,39,16,"on"],[44,20,39,18],[44,21,39,19],[44,33,39,31],[44,35,39,33],[44,41,39,39],[45,8,40,6,"console"],[45,15,40,13],[45,16,40,14,"log"],[45,19,40,17],[45,20,40,18],[45,41,40,39],[45,42,40,40],[46,6,41,4],[46,7,41,5],[46,8,41,6],[47,4,42,2],[48,4,44,2,"disconnect"],[48,14,44,12,"disconnect"],[48,15,44,12],[48,17,44,15],[49,6,45,4],[49,10,45,8],[49,14,45,12],[49,15,45,13,"socket"],[49,21,45,19],[49,23,45,21],[50,8,46,6],[50,12,46,10],[50,13,46,11,"socket"],[50,19,46,17],[50,20,46,18,"disconnect"],[50,30,46,28],[50,31,46,29],[50,32,46,30],[51,8,47,6],[51,12,47,10],[51,13,47,11,"socket"],[51,19,47,17],[51,22,47,20],[51,26,47,24],[52,8,48,6],[52,12,48,10],[52,13,48,11,"listeners"],[52,22,48,20],[52,23,48,21,"clear"],[52,28,48,26],[52,29,48,27],[52,30,48,28],[53,6,49,4],[54,4,50,2],[55,4,52,2,"joinCommunity"],[55,17,52,15,"joinCommunity"],[55,18,52,15],[55,20,52,18],[56,6,53,4],[56,10,53,8],[56,11,53,9],[56,15,53,13],[56,16,53,14,"socket"],[56,22,53,20],[56,24,53,22],[57,6,54,4],[57,10,54,8],[57,11,54,9,"socket"],[57,17,54,15],[57,18,54,16,"emit"],[57,22,54,20],[57,23,54,21],[57,39,54,37],[57,41,54,39],[57,42,54,40],[57,43,54,41],[57,44,54,42],[58,4,55,2],[59,4,57,2,"sendMessage"],[59,15,57,13,"sendMessage"],[59,16,57,14,"message"],[59,23,57,29],[59,25,57,31],[60,6,58,4],[60,10,58,8],[60,11,58,9],[60,15,58,13],[60,16,58,14,"socket"],[60,22,58,20],[60,24,58,22],[61,6,59,4],[61,10,59,8],[61,11,59,9,"socket"],[61,17,59,15],[61,18,59,16,"emit"],[61,22,59,20],[61,23,59,21],[61,37,59,35],[61,39,59,37],[62,8,59,39,"message"],[63,6,59,47],[63,7,59,48],[63,8,59,49],[64,4,60,2],[65,4,62,2,"onNewMessage"],[65,16,62,14,"onNewMessage"],[65,17,62,15,"callback"],[65,25,62,44],[65,27,62,46],[66,6,63,4],[66,10,63,8],[66,11,63,9],[66,15,63,13],[66,16,63,14,"socket"],[66,22,63,20],[66,24,63,22],[66,31,63,29],[66,37,63,35],[66,38,63,36],[66,39,63,37],[67,6,65,4],[67,10,65,8],[67,11,65,9,"socket"],[67,17,65,15],[67,18,65,16,"on"],[67,20,65,18],[67,21,65,19],[67,34,65,32],[67,36,65,34,"callback"],[67,44,65,42],[67,45,65,43],[69,6,67,4],[70,6,68,4],[70,10,68,8],[70,11,68,9],[70,15,68,13],[70,16,68,14,"listeners"],[70,25,68,23],[70,26,68,24,"has"],[70,29,68,27],[70,30,68,28],[70,43,68,41],[70,44,68,42],[70,46,68,44],[71,8,69,6],[71,12,69,10],[71,13,69,11,"listeners"],[71,22,69,20],[71,23,69,21,"set"],[71,26,69,24],[71,27,69,25],[71,40,69,38],[71,42,69,40],[71,44,69,42],[71,45,69,43],[72,6,70,4],[73,6,71,4],[73,10,71,8],[73,11,71,9,"listeners"],[73,20,71,18],[73,21,71,19,"get"],[73,24,71,22],[73,25,71,23],[73,38,71,36],[73,39,71,37],[73,41,71,39,"push"],[73,45,71,43],[73,46,71,44,"callback"],[73,54,71,52],[73,55,71,53],[74,6,73,4],[74,13,73,11],[74,19,73,17],[75,8,74,6],[75,12,74,10],[75,13,74,11,"socket"],[75,19,74,17],[75,21,74,19,"off"],[75,24,74,22],[75,25,74,23],[75,38,74,36],[75,40,74,38,"callback"],[75,48,74,46],[75,49,74,47],[76,6,75,4],[76,7,75,5],[77,4,76,2],[78,4,78,2,"onUserJoined"],[78,16,78,14,"onUserJoined"],[78,17,78,15,"callback"],[78,25,78,44],[78,27,78,46],[79,6,79,4],[79,10,79,8],[79,11,79,9],[79,15,79,13],[79,16,79,14,"socket"],[79,22,79,20],[79,24,79,22],[79,31,79,29],[79,37,79,35],[79,38,79,36],[79,39,79,37],[80,6,80,4],[80,10,80,8],[80,11,80,9,"socket"],[80,17,80,15],[80,18,80,16,"on"],[80,20,80,18],[80,21,80,19],[80,34,80,32],[80,36,80,34,"callback"],[80,44,80,42],[80,45,80,43],[81,6,81,4],[81,13,81,11],[81,19,81,17],[82,8,82,6],[82,12,82,10],[82,13,82,11,"socket"],[82,19,82,17],[82,21,82,19,"off"],[82,24,82,22],[82,25,82,23],[82,38,82,36],[82,40,82,38,"callback"],[82,48,82,46],[82,49,82,47],[83,6,83,4],[83,7,83,5],[84,4,84,2],[85,4,86,2,"emitTyping"],[85,14,86,12,"emitTyping"],[85,15,86,12],[85,17,86,15],[86,6,87,4],[86,10,87,8],[86,11,87,9],[86,15,87,13],[86,16,87,14,"socket"],[86,22,87,20],[86,24,87,22],[87,6,88,4],[87,10,88,8],[87,11,88,9,"socket"],[87,17,88,15],[87,18,88,16,"emit"],[87,22,88,20],[87,23,88,21],[87,31,88,29],[87,33,88,31],[87,34,88,32],[87,35,88,33],[87,36,88,34],[88,4,89,2],[89,4,91,2,"isConnected"],[89,15,91,13,"isConnected"],[89,16,91,13],[89,18,91,25],[90,6,92,4],[90,13,92,11],[90,17,92,15],[90,18,92,16,"socket"],[90,24,92,22],[90,26,92,24,"connected"],[90,35,92,33],[90,39,92,37],[90,44,92,42],[91,4,93,2],[92,2,94,0],[93,2,96,7],[93,8,96,13,"socketService"],[93,21,96,26],[93,24,96,29],[93,28,96,33,"SocketService"],[93,41,96,46],[93,42,96,47],[93,43,96,48],[94,0,96,49],[94,3]],"functionMap":{"names":["<global>","SocketService","SocketService#connect","on$argument_1","SocketService#disconnect","SocketService#joinCommunity","SocketService#sendMessage","SocketService#onNewMessage","<anonymous>","SocketService#onUserJoined","SocketService#emitTyping","SocketService#isConnected"],"mappings":"AAA;ACK;ECI;8BCgB;KDG;oCCE;KDE;oCCE;KDE;iCCE;KDE;GDC;EGE;GHM;EIE;GJG;EKE;GLG;EME;6BCC,QD;WCU;KDE;GNC;EQE;6BDC,QC;WDE;KCE;GRC;ESE;GTG;EUE;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}