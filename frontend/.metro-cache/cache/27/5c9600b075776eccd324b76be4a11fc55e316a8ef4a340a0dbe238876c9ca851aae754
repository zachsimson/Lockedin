{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"],"imports":1}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersClassCallCheck = require(_dependencyMap[1], \"@babel/runtime/helpers/classCallCheck\");\n  var _classCallCheck = _interopDefault(_babelRuntimeHelpersClassCallCheck);\n  var _babelRuntimeHelpersCreateClass = require(_dependencyMap[2], \"@babel/runtime/helpers/createClass\");\n  var _createClass = _interopDefault(_babelRuntimeHelpersCreateClass);\n  var _expoVirtualEnv = require(_dependencyMap[3], \"expo/virtual/env\");\n  var _socketIoClient = require(_dependencyMap[4], \"socket.io-client\");\n  var SOCKET_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n  var SocketService = /*#__PURE__*/function () {\n    function SocketService() {\n      (0, _classCallCheck.default)(this, SocketService);\n      this.socket = null;\n      this.listeners = new Map();\n    }\n    return (0, _createClass.default)(SocketService, [{\n      key: \"connect\",\n      value: function () {\n        var _connect = (0, _asyncToGenerator.default)(function* () {\n          if (this.socket?.connected) return;\n          var token = yield SecureStore.getItemAsync('authToken');\n          if (!token) {\n            console.log('No auth token found');\n            return;\n          }\n          this.socket = (0, _socketIoClient.io)(SOCKET_URL, {\n            transports: ['websocket', 'polling'],\n            reconnection: true,\n            reconnectionDelay: 1000,\n            reconnectionAttempts: 5\n          });\n          this.socket.on('connect', () => {\n            console.log('Socket connected');\n            this.socket?.emit('authenticate', {\n              token\n            });\n          });\n          this.socket.on('authenticated', data => {\n            console.log('Socket authenticated:', data);\n          });\n          this.socket.on('connect_error', error => {\n            console.error('Socket connection error:', error);\n          });\n          this.socket.on('disconnect', () => {\n            console.log('Socket disconnected');\n          });\n        });\n        function connect() {\n          return _connect.apply(this, arguments);\n        }\n        return connect;\n      }()\n    }, {\n      key: \"disconnect\",\n      value: function disconnect() {\n        if (this.socket) {\n          this.socket.disconnect();\n          this.socket = null;\n          this.listeners.clear();\n        }\n      }\n    }, {\n      key: \"joinCommunity\",\n      value: function joinCommunity() {\n        if (!this.socket) return;\n        this.socket.emit('join_community', {});\n      }\n    }, {\n      key: \"sendMessage\",\n      value: function sendMessage(message) {\n        if (!this.socket) return;\n        this.socket.emit('send_message', {\n          message\n        });\n      }\n    }, {\n      key: \"onNewMessage\",\n      value: function onNewMessage(callback) {\n        if (!this.socket) return () => {};\n        this.socket.on('new_message', callback);\n\n        // Store listener for cleanup\n        if (!this.listeners.has('new_message')) {\n          this.listeners.set('new_message', []);\n        }\n        this.listeners.get('new_message')?.push(callback);\n        return () => {\n          this.socket?.off('new_message', callback);\n        };\n      }\n    }, {\n      key: \"onUserJoined\",\n      value: function onUserJoined(callback) {\n        if (!this.socket) return () => {};\n        this.socket.on('user_joined', callback);\n        return () => {\n          this.socket?.off('user_joined', callback);\n        };\n      }\n    }, {\n      key: \"emitTyping\",\n      value: function emitTyping() {\n        if (!this.socket) return;\n        this.socket.emit('typing', {});\n      }\n    }, {\n      key: \"isConnected\",\n      value: function isConnected() {\n        return this.socket?.connected || false;\n      }\n    }]);\n  }();\n  var socketService = new SocketService();\n});","lineCount":131,"map":[[12,2,96,0,"Object"],[12,8,96,0],[12,9,96,0,"defineProperty"],[12,23,96,0],[12,24,96,0,"exports"],[12,31,96,0],[13,4,96,0,"enumerable"],[13,14,96,0],[14,4,96,0,"get"],[14,7,96,0],[14,18,96,0,"get"],[14,19,96,0],[15,6,96,0],[15,13,96,0,"socketService"],[15,26,96,0],[16,4,96,0],[17,2,96,0],[18,2,96,49],[18,6,96,49,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,96,49],[18,45,96,49,"require"],[18,52,96,49],[18,53,96,49,"_dependencyMap"],[18,67,96,49],[19,2,96,49],[19,6,96,49,"_asyncToGenerator"],[19,23,96,49],[19,26,96,49,"_interopDefault"],[19,41,96,49],[19,42,96,49,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,96,49],[20,2,96,49],[20,6,96,49,"_babelRuntimeHelpersClassCallCheck"],[20,40,96,49],[20,43,96,49,"require"],[20,50,96,49],[20,51,96,49,"_dependencyMap"],[20,65,96,49],[21,2,96,49],[21,6,96,49,"_classCallCheck"],[21,21,96,49],[21,24,96,49,"_interopDefault"],[21,39,96,49],[21,40,96,49,"_babelRuntimeHelpersClassCallCheck"],[21,74,96,49],[22,2,96,49],[22,6,96,49,"_babelRuntimeHelpersCreateClass"],[22,37,96,49],[22,40,96,49,"require"],[22,47,96,49],[22,48,96,49,"_dependencyMap"],[22,62,96,49],[23,2,96,49],[23,6,96,49,"_createClass"],[23,18,96,49],[23,21,96,49,"_interopDefault"],[23,36,96,49],[23,37,96,49,"_babelRuntimeHelpersCreateClass"],[23,68,96,49],[24,2,96,49],[24,6,96,49,"_expoVirtualEnv"],[24,21,96,49],[24,24,96,49,"require"],[24,31,96,49],[24,32,96,49,"_dependencyMap"],[24,46,96,49],[25,2,1,0],[25,6,1,0,"_socketIoClient"],[25,21,1,0],[25,24,1,0,"require"],[25,31,1,0],[25,32,1,0,"_dependencyMap"],[25,46,1,0],[26,2,4,0],[26,6,4,6,"SOCKET_URL"],[26,16,4,16],[26,19,4,19,"_expoVirtualEnv"],[26,34,4,19],[26,35,4,19,"env"],[26,38,4,19],[26,39,4,19,"EXPO_PUBLIC_BACKEND_URL"],[26,62,4,19],[26,66,4,58],[26,89,4,81],[27,2,4,82],[27,6,6,6,"SocketService"],[27,19,6,19],[28,4,6,19],[28,13,6,19,"SocketService"],[28,27,6,19],[29,6,6,19],[29,10,6,19,"_classCallCheck"],[29,25,6,19],[29,26,6,19,"default"],[29,33,6,19],[29,41,6,19,"SocketService"],[29,54,6,19],[30,6,6,19],[30,11,7,10,"socket"],[30,17,7,16],[30,20,7,34],[30,24,7,38],[31,6,7,38],[31,11,8,10,"listeners"],[31,20,8,19],[31,23,8,47],[31,27,8,51,"Map"],[31,30,8,54],[31,31,8,55],[31,32,8,56],[32,4,8,56],[33,4,8,56],[33,15,8,56,"_createClass"],[33,27,8,56],[33,28,8,56,"default"],[33,35,8,56],[33,37,8,56,"SocketService"],[33,50,8,56],[34,6,8,56,"key"],[34,9,8,56],[35,6,8,56,"value"],[35,11,8,56],[36,8,8,56],[36,12,8,56,"_connect"],[36,20,8,56],[36,27,8,56,"_asyncToGenerator"],[36,44,8,56],[36,45,8,56,"default"],[36,52,8,56],[36,54,10,2],[36,67,10,18],[37,10,11,4],[37,14,11,8],[37,18,11,12],[37,19,11,13,"socket"],[37,25,11,19],[37,27,11,21,"connected"],[37,36,11,30],[37,38,11,32],[38,10,13,4],[38,14,13,10,"token"],[38,19,13,15],[38,28,13,24,"SecureStore"],[38,39,13,35],[38,40,13,36,"getItemAsync"],[38,52,13,48],[38,53,13,49],[38,64,13,60],[38,65,13,61],[39,10,14,4],[39,14,14,8],[39,15,14,9,"token"],[39,20,14,14],[39,22,14,16],[40,12,15,6,"console"],[40,19,15,13],[40,20,15,14,"log"],[40,23,15,17],[40,24,15,18],[40,45,15,39],[40,46,15,40],[41,12,16,6],[42,10,17,4],[43,10,19,4],[43,14,19,8],[43,15,19,9,"socket"],[43,21,19,15],[43,24,19,18],[43,28,19,18,"io"],[43,43,19,20],[43,44,19,20,"io"],[43,46,19,20],[43,48,19,21,"SOCKET_URL"],[43,58,19,31],[43,60,19,33],[44,12,20,6,"transports"],[44,22,20,16],[44,24,20,18],[44,25,20,19],[44,36,20,30],[44,38,20,32],[44,47,20,41],[44,48,20,42],[45,12,21,6,"reconnection"],[45,24,21,18],[45,26,21,20],[45,30,21,24],[46,12,22,6,"reconnectionDelay"],[46,29,22,23],[46,31,22,25],[46,35,22,29],[47,12,23,6,"reconnectionAttempts"],[47,32,23,26],[47,34,23,28],[48,10,24,4],[48,11,24,5],[48,12,24,6],[49,10,26,4],[49,14,26,8],[49,15,26,9,"socket"],[49,21,26,15],[49,22,26,16,"on"],[49,24,26,18],[49,25,26,19],[49,34,26,28],[49,36,26,30],[49,42,26,36],[50,12,27,6,"console"],[50,19,27,13],[50,20,27,14,"log"],[50,23,27,17],[50,24,27,18],[50,42,27,36],[50,43,27,37],[51,12,28,6],[51,16,28,10],[51,17,28,11,"socket"],[51,23,28,17],[51,25,28,19,"emit"],[51,29,28,23],[51,30,28,24],[51,44,28,38],[51,46,28,40],[52,14,28,42,"token"],[53,12,28,48],[53,13,28,49],[53,14,28,50],[54,10,29,4],[54,11,29,5],[54,12,29,6],[55,10,31,4],[55,14,31,8],[55,15,31,9,"socket"],[55,21,31,15],[55,22,31,16,"on"],[55,24,31,18],[55,25,31,19],[55,40,31,34],[55,42,31,37,"data"],[55,46,31,41],[55,50,31,46],[56,12,32,6,"console"],[56,19,32,13],[56,20,32,14,"log"],[56,23,32,17],[56,24,32,18],[56,47,32,41],[56,49,32,43,"data"],[56,53,32,47],[56,54,32,48],[57,10,33,4],[57,11,33,5],[57,12,33,6],[58,10,35,4],[58,14,35,8],[58,15,35,9,"socket"],[58,21,35,15],[58,22,35,16,"on"],[58,24,35,18],[58,25,35,19],[58,40,35,34],[58,42,35,37,"error"],[58,47,35,42],[58,51,35,47],[59,12,36,6,"console"],[59,19,36,13],[59,20,36,14,"error"],[59,25,36,19],[59,26,36,20],[59,52,36,46],[59,54,36,48,"error"],[59,59,36,53],[59,60,36,54],[60,10,37,4],[60,11,37,5],[60,12,37,6],[61,10,39,4],[61,14,39,8],[61,15,39,9,"socket"],[61,21,39,15],[61,22,39,16,"on"],[61,24,39,18],[61,25,39,19],[61,37,39,31],[61,39,39,33],[61,45,39,39],[62,12,40,6,"console"],[62,19,40,13],[62,20,40,14,"log"],[62,23,40,17],[62,24,40,18],[62,45,40,39],[62,46,40,40],[63,10,41,4],[63,11,41,5],[63,12,41,6],[64,8,42,2],[64,9,42,3],[65,8,42,3],[65,17,10,8,"connect"],[65,24,10,15,"connect"],[65,25,10,15],[66,10,10,15],[66,17,10,15,"_connect"],[66,25,10,15],[66,26,10,15,"apply"],[66,31,10,15],[66,38,10,15,"arguments"],[66,47,10,15],[67,8,10,15],[68,8,10,15],[68,15,10,8,"connect"],[68,22,10,15],[69,6,10,15],[70,4,10,15],[71,6,10,15,"key"],[71,9,10,15],[72,6,10,15,"value"],[72,11,10,15],[72,13,44,2],[72,22,44,2,"disconnect"],[72,32,44,12,"disconnect"],[72,33,44,12],[72,35,44,15],[73,8,45,4],[73,12,45,8],[73,16,45,12],[73,17,45,13,"socket"],[73,23,45,19],[73,25,45,21],[74,10,46,6],[74,14,46,10],[74,15,46,11,"socket"],[74,21,46,17],[74,22,46,18,"disconnect"],[74,32,46,28],[74,33,46,29],[74,34,46,30],[75,10,47,6],[75,14,47,10],[75,15,47,11,"socket"],[75,21,47,17],[75,24,47,20],[75,28,47,24],[76,10,48,6],[76,14,48,10],[76,15,48,11,"listeners"],[76,24,48,20],[76,25,48,21,"clear"],[76,30,48,26],[76,31,48,27],[76,32,48,28],[77,8,49,4],[78,6,50,2],[79,4,50,3],[80,6,50,3,"key"],[80,9,50,3],[81,6,50,3,"value"],[81,11,50,3],[81,13,52,2],[81,22,52,2,"joinCommunity"],[81,35,52,15,"joinCommunity"],[81,36,52,15],[81,38,52,18],[82,8,53,4],[82,12,53,8],[82,13,53,9],[82,17,53,13],[82,18,53,14,"socket"],[82,24,53,20],[82,26,53,22],[83,8,54,4],[83,12,54,8],[83,13,54,9,"socket"],[83,19,54,15],[83,20,54,16,"emit"],[83,24,54,20],[83,25,54,21],[83,41,54,37],[83,43,54,39],[83,44,54,40],[83,45,54,41],[83,46,54,42],[84,6,55,2],[85,4,55,3],[86,6,55,3,"key"],[86,9,55,3],[87,6,55,3,"value"],[87,11,55,3],[87,13,57,2],[87,22,57,2,"sendMessage"],[87,33,57,13,"sendMessage"],[87,34,57,14,"message"],[87,41,57,29],[87,43,57,31],[88,8,58,4],[88,12,58,8],[88,13,58,9],[88,17,58,13],[88,18,58,14,"socket"],[88,24,58,20],[88,26,58,22],[89,8,59,4],[89,12,59,8],[89,13,59,9,"socket"],[89,19,59,15],[89,20,59,16,"emit"],[89,24,59,20],[89,25,59,21],[89,39,59,35],[89,41,59,37],[90,10,59,39,"message"],[91,8,59,47],[91,9,59,48],[91,10,59,49],[92,6,60,2],[93,4,60,3],[94,6,60,3,"key"],[94,9,60,3],[95,6,60,3,"value"],[95,11,60,3],[95,13,62,2],[95,22,62,2,"onNewMessage"],[95,34,62,14,"onNewMessage"],[95,35,62,15,"callback"],[95,43,62,44],[95,45,62,46],[96,8,63,4],[96,12,63,8],[96,13,63,9],[96,17,63,13],[96,18,63,14,"socket"],[96,24,63,20],[96,26,63,22],[96,33,63,29],[96,39,63,35],[96,40,63,36],[96,41,63,37],[97,8,65,4],[97,12,65,8],[97,13,65,9,"socket"],[97,19,65,15],[97,20,65,16,"on"],[97,22,65,18],[97,23,65,19],[97,36,65,32],[97,38,65,34,"callback"],[97,46,65,42],[97,47,65,43],[99,8,67,4],[100,8,68,4],[100,12,68,8],[100,13,68,9],[100,17,68,13],[100,18,68,14,"listeners"],[100,27,68,23],[100,28,68,24,"has"],[100,31,68,27],[100,32,68,28],[100,45,68,41],[100,46,68,42],[100,48,68,44],[101,10,69,6],[101,14,69,10],[101,15,69,11,"listeners"],[101,24,69,20],[101,25,69,21,"set"],[101,28,69,24],[101,29,69,25],[101,42,69,38],[101,44,69,40],[101,46,69,42],[101,47,69,43],[102,8,70,4],[103,8,71,4],[103,12,71,8],[103,13,71,9,"listeners"],[103,22,71,18],[103,23,71,19,"get"],[103,26,71,22],[103,27,71,23],[103,40,71,36],[103,41,71,37],[103,43,71,39,"push"],[103,47,71,43],[103,48,71,44,"callback"],[103,56,71,52],[103,57,71,53],[104,8,73,4],[104,15,73,11],[104,21,73,17],[105,10,74,6],[105,14,74,10],[105,15,74,11,"socket"],[105,21,74,17],[105,23,74,19,"off"],[105,26,74,22],[105,27,74,23],[105,40,74,36],[105,42,74,38,"callback"],[105,50,74,46],[105,51,74,47],[106,8,75,4],[106,9,75,5],[107,6,76,2],[108,4,76,3],[109,6,76,3,"key"],[109,9,76,3],[110,6,76,3,"value"],[110,11,76,3],[110,13,78,2],[110,22,78,2,"onUserJoined"],[110,34,78,14,"onUserJoined"],[110,35,78,15,"callback"],[110,43,78,44],[110,45,78,46],[111,8,79,4],[111,12,79,8],[111,13,79,9],[111,17,79,13],[111,18,79,14,"socket"],[111,24,79,20],[111,26,79,22],[111,33,79,29],[111,39,79,35],[111,40,79,36],[111,41,79,37],[112,8,80,4],[112,12,80,8],[112,13,80,9,"socket"],[112,19,80,15],[112,20,80,16,"on"],[112,22,80,18],[112,23,80,19],[112,36,80,32],[112,38,80,34,"callback"],[112,46,80,42],[112,47,80,43],[113,8,81,4],[113,15,81,11],[113,21,81,17],[114,10,82,6],[114,14,82,10],[114,15,82,11,"socket"],[114,21,82,17],[114,23,82,19,"off"],[114,26,82,22],[114,27,82,23],[114,40,82,36],[114,42,82,38,"callback"],[114,50,82,46],[114,51,82,47],[115,8,83,4],[115,9,83,5],[116,6,84,2],[117,4,84,3],[118,6,84,3,"key"],[118,9,84,3],[119,6,84,3,"value"],[119,11,84,3],[119,13,86,2],[119,22,86,2,"emitTyping"],[119,32,86,12,"emitTyping"],[119,33,86,12],[119,35,86,15],[120,8,87,4],[120,12,87,8],[120,13,87,9],[120,17,87,13],[120,18,87,14,"socket"],[120,24,87,20],[120,26,87,22],[121,8,88,4],[121,12,88,8],[121,13,88,9,"socket"],[121,19,88,15],[121,20,88,16,"emit"],[121,24,88,20],[121,25,88,21],[121,33,88,29],[121,35,88,31],[121,36,88,32],[121,37,88,33],[121,38,88,34],[122,6,89,2],[123,4,89,3],[124,6,89,3,"key"],[124,9,89,3],[125,6,89,3,"value"],[125,11,89,3],[125,13,91,2],[125,22,91,2,"isConnected"],[125,33,91,13,"isConnected"],[125,34,91,13],[125,36,91,25],[126,8,92,4],[126,15,92,11],[126,19,92,15],[126,20,92,16,"socket"],[126,26,92,22],[126,28,92,24,"connected"],[126,37,92,33],[126,41,92,37],[126,46,92,42],[127,6,93,2],[128,4,93,3],[129,2,93,3],[130,2,96,7],[130,6,96,13,"socketService"],[130,19,96,26],[130,22,96,29],[130,26,96,33,"SocketService"],[130,39,96,46],[130,40,96,47],[130,41,96,48],[131,0,96,49],[131,3]],"functionMap":{"names":["<global>","SocketService","SocketService#connect","on$argument_1","SocketService#disconnect","SocketService#joinCommunity","SocketService#sendMessage","SocketService#onNewMessage","<anonymous>","SocketService#onUserJoined","SocketService#emitTyping","SocketService#isConnected"],"mappings":"AAA;ACK;ECI;8BCgB;KDG;oCCE;KDE;oCCE;KDE;iCCE;KDE;GDC;EGE;GHM;EIE;GJG;EKE;GLG;EME;6BCC,QD;WCU;KDE;GNC;EQE;6BDC,QC;WDE;KCE;GRC;ESE;GTG;EUE;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}