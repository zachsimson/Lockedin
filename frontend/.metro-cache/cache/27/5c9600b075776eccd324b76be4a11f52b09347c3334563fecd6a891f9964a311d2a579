{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"],"imports":1}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}},{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":32,"index":79}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersClassCallCheck = require(_dependencyMap[1], \"@babel/runtime/helpers/classCallCheck\");\n  var _classCallCheck = _interopDefault(_babelRuntimeHelpersClassCallCheck);\n  var _babelRuntimeHelpersCreateClass = require(_dependencyMap[2], \"@babel/runtime/helpers/createClass\");\n  var _createClass = _interopDefault(_babelRuntimeHelpersCreateClass);\n  var _expoVirtualEnv = require(_dependencyMap[3], \"expo/virtual/env\");\n  var _socketIoClient = require(_dependencyMap[4], \"socket.io-client\");\n  var _storage = require(_dependencyMap[5], \"./storage\");\n  var storage = _interopDefault(_storage);\n  var SOCKET_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || '/api';\n  var SocketService = /*#__PURE__*/function () {\n    function SocketService() {\n      (0, _classCallCheck.default)(this, SocketService);\n      this.socket = null;\n      this.listeners = new Map();\n    }\n    return (0, _createClass.default)(SocketService, [{\n      key: \"connect\",\n      value: function () {\n        var _connect = (0, _asyncToGenerator.default)(function* () {\n          if (this.socket?.connected) return;\n          var token = yield storage.default.getItem('authToken');\n          if (!token) {\n            console.log('No auth token found');\n            return;\n          }\n          this.socket = (0, _socketIoClient.io)(SOCKET_URL, {\n            transports: ['websocket', 'polling'],\n            reconnection: true,\n            reconnectionDelay: 1000,\n            reconnectionAttempts: 5\n          });\n          this.socket.on('connect', () => {\n            console.log('Socket connected');\n            this.socket?.emit('authenticate', {\n              token\n            });\n          });\n          this.socket.on('authenticated', data => {\n            console.log('Socket authenticated:', data);\n          });\n          this.socket.on('connect_error', error => {\n            console.error('Socket connection error:', error);\n          });\n          this.socket.on('disconnect', () => {\n            console.log('Socket disconnected');\n          });\n        });\n        function connect() {\n          return _connect.apply(this, arguments);\n        }\n        return connect;\n      }()\n    }, {\n      key: \"disconnect\",\n      value: function disconnect() {\n        if (this.socket) {\n          this.socket.disconnect();\n          this.socket = null;\n          this.listeners.clear();\n        }\n      }\n    }, {\n      key: \"joinCommunity\",\n      value: function joinCommunity() {\n        if (!this.socket) return;\n        this.socket.emit('join_community', {});\n      }\n    }, {\n      key: \"sendMessage\",\n      value: function sendMessage(message) {\n        if (!this.socket) return;\n        this.socket.emit('send_message', {\n          message\n        });\n      }\n    }, {\n      key: \"onNewMessage\",\n      value: function onNewMessage(callback) {\n        if (!this.socket) return () => {};\n        this.socket.on('new_message', callback);\n\n        // Store listener for cleanup\n        if (!this.listeners.has('new_message')) {\n          this.listeners.set('new_message', []);\n        }\n        this.listeners.get('new_message')?.push(callback);\n        return () => {\n          this.socket?.off('new_message', callback);\n        };\n      }\n    }, {\n      key: \"onUserJoined\",\n      value: function onUserJoined(callback) {\n        if (!this.socket) return () => {};\n        this.socket.on('user_joined', callback);\n        return () => {\n          this.socket?.off('user_joined', callback);\n        };\n      }\n    }, {\n      key: \"emitTyping\",\n      value: function emitTyping() {\n        if (!this.socket) return;\n        this.socket.emit('typing', {});\n      }\n    }, {\n      key: \"isConnected\",\n      value: function isConnected() {\n        return this.socket?.connected || false;\n      }\n    }]);\n  }();\n  var socketService = new SocketService();\n});","lineCount":133,"map":[[12,2,96,0,"Object"],[12,8,96,0],[12,9,96,0,"defineProperty"],[12,23,96,0],[12,24,96,0,"exports"],[12,31,96,0],[13,4,96,0,"enumerable"],[13,14,96,0],[14,4,96,0,"get"],[14,7,96,0],[14,18,96,0,"get"],[14,19,96,0],[15,6,96,0],[15,13,96,0,"socketService"],[15,26,96,0],[16,4,96,0],[17,2,96,0],[18,2,96,49],[18,6,96,49,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,96,49],[18,45,96,49,"require"],[18,52,96,49],[18,53,96,49,"_dependencyMap"],[18,67,96,49],[19,2,96,49],[19,6,96,49,"_asyncToGenerator"],[19,23,96,49],[19,26,96,49,"_interopDefault"],[19,41,96,49],[19,42,96,49,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,96,49],[20,2,96,49],[20,6,96,49,"_babelRuntimeHelpersClassCallCheck"],[20,40,96,49],[20,43,96,49,"require"],[20,50,96,49],[20,51,96,49,"_dependencyMap"],[20,65,96,49],[21,2,96,49],[21,6,96,49,"_classCallCheck"],[21,21,96,49],[21,24,96,49,"_interopDefault"],[21,39,96,49],[21,40,96,49,"_babelRuntimeHelpersClassCallCheck"],[21,74,96,49],[22,2,96,49],[22,6,96,49,"_babelRuntimeHelpersCreateClass"],[22,37,96,49],[22,40,96,49,"require"],[22,47,96,49],[22,48,96,49,"_dependencyMap"],[22,62,96,49],[23,2,96,49],[23,6,96,49,"_createClass"],[23,18,96,49],[23,21,96,49,"_interopDefault"],[23,36,96,49],[23,37,96,49,"_babelRuntimeHelpersCreateClass"],[23,68,96,49],[24,2,96,49],[24,6,96,49,"_expoVirtualEnv"],[24,21,96,49],[24,24,96,49,"require"],[24,31,96,49],[24,32,96,49,"_dependencyMap"],[24,46,96,49],[25,2,1,0],[25,6,1,0,"_socketIoClient"],[25,21,1,0],[25,24,1,0,"require"],[25,31,1,0],[25,32,1,0,"_dependencyMap"],[25,46,1,0],[26,2,2,0],[26,6,2,0,"_storage"],[26,14,2,0],[26,17,2,0,"require"],[26,24,2,0],[26,25,2,0,"_dependencyMap"],[26,39,2,0],[27,2,2,0],[27,6,2,0,"storage"],[27,13,2,0],[27,16,2,0,"_interopDefault"],[27,31,2,0],[27,32,2,0,"_storage"],[27,40,2,0],[28,2,4,0],[28,6,4,6,"SOCKET_URL"],[28,16,4,16],[28,19,4,19,"_expoVirtualEnv"],[28,34,4,19],[28,35,4,19,"env"],[28,38,4,19],[28,39,4,19,"EXPO_PUBLIC_BACKEND_URL"],[28,62,4,19],[28,66,4,58],[28,72,4,64],[29,2,4,65],[29,6,6,6,"SocketService"],[29,19,6,19],[30,4,6,19],[30,13,6,19,"SocketService"],[30,27,6,19],[31,6,6,19],[31,10,6,19,"_classCallCheck"],[31,25,6,19],[31,26,6,19,"default"],[31,33,6,19],[31,41,6,19,"SocketService"],[31,54,6,19],[32,6,6,19],[32,11,7,10,"socket"],[32,17,7,16],[32,20,7,34],[32,24,7,38],[33,6,7,38],[33,11,8,10,"listeners"],[33,20,8,19],[33,23,8,47],[33,27,8,51,"Map"],[33,30,8,54],[33,31,8,55],[33,32,8,56],[34,4,8,56],[35,4,8,56],[35,15,8,56,"_createClass"],[35,27,8,56],[35,28,8,56,"default"],[35,35,8,56],[35,37,8,56,"SocketService"],[35,50,8,56],[36,6,8,56,"key"],[36,9,8,56],[37,6,8,56,"value"],[37,11,8,56],[38,8,8,56],[38,12,8,56,"_connect"],[38,20,8,56],[38,27,8,56,"_asyncToGenerator"],[38,44,8,56],[38,45,8,56,"default"],[38,52,8,56],[38,54,10,2],[38,67,10,18],[39,10,11,4],[39,14,11,8],[39,18,11,12],[39,19,11,13,"socket"],[39,25,11,19],[39,27,11,21,"connected"],[39,36,11,30],[39,38,11,32],[40,10,13,4],[40,14,13,10,"token"],[40,19,13,15],[40,28,13,24,"storage"],[40,35,13,31],[40,36,13,31,"default"],[40,43,13,31],[40,44,13,32,"getItem"],[40,51,13,39],[40,52,13,40],[40,63,13,51],[40,64,13,52],[41,10,14,4],[41,14,14,8],[41,15,14,9,"token"],[41,20,14,14],[41,22,14,16],[42,12,15,6,"console"],[42,19,15,13],[42,20,15,14,"log"],[42,23,15,17],[42,24,15,18],[42,45,15,39],[42,46,15,40],[43,12,16,6],[44,10,17,4],[45,10,19,4],[45,14,19,8],[45,15,19,9,"socket"],[45,21,19,15],[45,24,19,18],[45,28,19,18,"io"],[45,43,19,20],[45,44,19,20,"io"],[45,46,19,20],[45,48,19,21,"SOCKET_URL"],[45,58,19,31],[45,60,19,33],[46,12,20,6,"transports"],[46,22,20,16],[46,24,20,18],[46,25,20,19],[46,36,20,30],[46,38,20,32],[46,47,20,41],[46,48,20,42],[47,12,21,6,"reconnection"],[47,24,21,18],[47,26,21,20],[47,30,21,24],[48,12,22,6,"reconnectionDelay"],[48,29,22,23],[48,31,22,25],[48,35,22,29],[49,12,23,6,"reconnectionAttempts"],[49,32,23,26],[49,34,23,28],[50,10,24,4],[50,11,24,5],[50,12,24,6],[51,10,26,4],[51,14,26,8],[51,15,26,9,"socket"],[51,21,26,15],[51,22,26,16,"on"],[51,24,26,18],[51,25,26,19],[51,34,26,28],[51,36,26,30],[51,42,26,36],[52,12,27,6,"console"],[52,19,27,13],[52,20,27,14,"log"],[52,23,27,17],[52,24,27,18],[52,42,27,36],[52,43,27,37],[53,12,28,6],[53,16,28,10],[53,17,28,11,"socket"],[53,23,28,17],[53,25,28,19,"emit"],[53,29,28,23],[53,30,28,24],[53,44,28,38],[53,46,28,40],[54,14,28,42,"token"],[55,12,28,48],[55,13,28,49],[55,14,28,50],[56,10,29,4],[56,11,29,5],[56,12,29,6],[57,10,31,4],[57,14,31,8],[57,15,31,9,"socket"],[57,21,31,15],[57,22,31,16,"on"],[57,24,31,18],[57,25,31,19],[57,40,31,34],[57,42,31,37,"data"],[57,46,31,41],[57,50,31,46],[58,12,32,6,"console"],[58,19,32,13],[58,20,32,14,"log"],[58,23,32,17],[58,24,32,18],[58,47,32,41],[58,49,32,43,"data"],[58,53,32,47],[58,54,32,48],[59,10,33,4],[59,11,33,5],[59,12,33,6],[60,10,35,4],[60,14,35,8],[60,15,35,9,"socket"],[60,21,35,15],[60,22,35,16,"on"],[60,24,35,18],[60,25,35,19],[60,40,35,34],[60,42,35,37,"error"],[60,47,35,42],[60,51,35,47],[61,12,36,6,"console"],[61,19,36,13],[61,20,36,14,"error"],[61,25,36,19],[61,26,36,20],[61,52,36,46],[61,54,36,48,"error"],[61,59,36,53],[61,60,36,54],[62,10,37,4],[62,11,37,5],[62,12,37,6],[63,10,39,4],[63,14,39,8],[63,15,39,9,"socket"],[63,21,39,15],[63,22,39,16,"on"],[63,24,39,18],[63,25,39,19],[63,37,39,31],[63,39,39,33],[63,45,39,39],[64,12,40,6,"console"],[64,19,40,13],[64,20,40,14,"log"],[64,23,40,17],[64,24,40,18],[64,45,40,39],[64,46,40,40],[65,10,41,4],[65,11,41,5],[65,12,41,6],[66,8,42,2],[66,9,42,3],[67,8,42,3],[67,17,10,8,"connect"],[67,24,10,15,"connect"],[67,25,10,15],[68,10,10,15],[68,17,10,15,"_connect"],[68,25,10,15],[68,26,10,15,"apply"],[68,31,10,15],[68,38,10,15,"arguments"],[68,47,10,15],[69,8,10,15],[70,8,10,15],[70,15,10,8,"connect"],[70,22,10,15],[71,6,10,15],[72,4,10,15],[73,6,10,15,"key"],[73,9,10,15],[74,6,10,15,"value"],[74,11,10,15],[74,13,44,2],[74,22,44,2,"disconnect"],[74,32,44,12,"disconnect"],[74,33,44,12],[74,35,44,15],[75,8,45,4],[75,12,45,8],[75,16,45,12],[75,17,45,13,"socket"],[75,23,45,19],[75,25,45,21],[76,10,46,6],[76,14,46,10],[76,15,46,11,"socket"],[76,21,46,17],[76,22,46,18,"disconnect"],[76,32,46,28],[76,33,46,29],[76,34,46,30],[77,10,47,6],[77,14,47,10],[77,15,47,11,"socket"],[77,21,47,17],[77,24,47,20],[77,28,47,24],[78,10,48,6],[78,14,48,10],[78,15,48,11,"listeners"],[78,24,48,20],[78,25,48,21,"clear"],[78,30,48,26],[78,31,48,27],[78,32,48,28],[79,8,49,4],[80,6,50,2],[81,4,50,3],[82,6,50,3,"key"],[82,9,50,3],[83,6,50,3,"value"],[83,11,50,3],[83,13,52,2],[83,22,52,2,"joinCommunity"],[83,35,52,15,"joinCommunity"],[83,36,52,15],[83,38,52,18],[84,8,53,4],[84,12,53,8],[84,13,53,9],[84,17,53,13],[84,18,53,14,"socket"],[84,24,53,20],[84,26,53,22],[85,8,54,4],[85,12,54,8],[85,13,54,9,"socket"],[85,19,54,15],[85,20,54,16,"emit"],[85,24,54,20],[85,25,54,21],[85,41,54,37],[85,43,54,39],[85,44,54,40],[85,45,54,41],[85,46,54,42],[86,6,55,2],[87,4,55,3],[88,6,55,3,"key"],[88,9,55,3],[89,6,55,3,"value"],[89,11,55,3],[89,13,57,2],[89,22,57,2,"sendMessage"],[89,33,57,13,"sendMessage"],[89,34,57,14,"message"],[89,41,57,29],[89,43,57,31],[90,8,58,4],[90,12,58,8],[90,13,58,9],[90,17,58,13],[90,18,58,14,"socket"],[90,24,58,20],[90,26,58,22],[91,8,59,4],[91,12,59,8],[91,13,59,9,"socket"],[91,19,59,15],[91,20,59,16,"emit"],[91,24,59,20],[91,25,59,21],[91,39,59,35],[91,41,59,37],[92,10,59,39,"message"],[93,8,59,47],[93,9,59,48],[93,10,59,49],[94,6,60,2],[95,4,60,3],[96,6,60,3,"key"],[96,9,60,3],[97,6,60,3,"value"],[97,11,60,3],[97,13,62,2],[97,22,62,2,"onNewMessage"],[97,34,62,14,"onNewMessage"],[97,35,62,15,"callback"],[97,43,62,44],[97,45,62,46],[98,8,63,4],[98,12,63,8],[98,13,63,9],[98,17,63,13],[98,18,63,14,"socket"],[98,24,63,20],[98,26,63,22],[98,33,63,29],[98,39,63,35],[98,40,63,36],[98,41,63,37],[99,8,65,4],[99,12,65,8],[99,13,65,9,"socket"],[99,19,65,15],[99,20,65,16,"on"],[99,22,65,18],[99,23,65,19],[99,36,65,32],[99,38,65,34,"callback"],[99,46,65,42],[99,47,65,43],[101,8,67,4],[102,8,68,4],[102,12,68,8],[102,13,68,9],[102,17,68,13],[102,18,68,14,"listeners"],[102,27,68,23],[102,28,68,24,"has"],[102,31,68,27],[102,32,68,28],[102,45,68,41],[102,46,68,42],[102,48,68,44],[103,10,69,6],[103,14,69,10],[103,15,69,11,"listeners"],[103,24,69,20],[103,25,69,21,"set"],[103,28,69,24],[103,29,69,25],[103,42,69,38],[103,44,69,40],[103,46,69,42],[103,47,69,43],[104,8,70,4],[105,8,71,4],[105,12,71,8],[105,13,71,9,"listeners"],[105,22,71,18],[105,23,71,19,"get"],[105,26,71,22],[105,27,71,23],[105,40,71,36],[105,41,71,37],[105,43,71,39,"push"],[105,47,71,43],[105,48,71,44,"callback"],[105,56,71,52],[105,57,71,53],[106,8,73,4],[106,15,73,11],[106,21,73,17],[107,10,74,6],[107,14,74,10],[107,15,74,11,"socket"],[107,21,74,17],[107,23,74,19,"off"],[107,26,74,22],[107,27,74,23],[107,40,74,36],[107,42,74,38,"callback"],[107,50,74,46],[107,51,74,47],[108,8,75,4],[108,9,75,5],[109,6,76,2],[110,4,76,3],[111,6,76,3,"key"],[111,9,76,3],[112,6,76,3,"value"],[112,11,76,3],[112,13,78,2],[112,22,78,2,"onUserJoined"],[112,34,78,14,"onUserJoined"],[112,35,78,15,"callback"],[112,43,78,44],[112,45,78,46],[113,8,79,4],[113,12,79,8],[113,13,79,9],[113,17,79,13],[113,18,79,14,"socket"],[113,24,79,20],[113,26,79,22],[113,33,79,29],[113,39,79,35],[113,40,79,36],[113,41,79,37],[114,8,80,4],[114,12,80,8],[114,13,80,9,"socket"],[114,19,80,15],[114,20,80,16,"on"],[114,22,80,18],[114,23,80,19],[114,36,80,32],[114,38,80,34,"callback"],[114,46,80,42],[114,47,80,43],[115,8,81,4],[115,15,81,11],[115,21,81,17],[116,10,82,6],[116,14,82,10],[116,15,82,11,"socket"],[116,21,82,17],[116,23,82,19,"off"],[116,26,82,22],[116,27,82,23],[116,40,82,36],[116,42,82,38,"callback"],[116,50,82,46],[116,51,82,47],[117,8,83,4],[117,9,83,5],[118,6,84,2],[119,4,84,3],[120,6,84,3,"key"],[120,9,84,3],[121,6,84,3,"value"],[121,11,84,3],[121,13,86,2],[121,22,86,2,"emitTyping"],[121,32,86,12,"emitTyping"],[121,33,86,12],[121,35,86,15],[122,8,87,4],[122,12,87,8],[122,13,87,9],[122,17,87,13],[122,18,87,14,"socket"],[122,24,87,20],[122,26,87,22],[123,8,88,4],[123,12,88,8],[123,13,88,9,"socket"],[123,19,88,15],[123,20,88,16,"emit"],[123,24,88,20],[123,25,88,21],[123,33,88,29],[123,35,88,31],[123,36,88,32],[123,37,88,33],[123,38,88,34],[124,6,89,2],[125,4,89,3],[126,6,89,3,"key"],[126,9,89,3],[127,6,89,3,"value"],[127,11,89,3],[127,13,91,2],[127,22,91,2,"isConnected"],[127,33,91,13,"isConnected"],[127,34,91,13],[127,36,91,25],[128,8,92,4],[128,15,92,11],[128,19,92,15],[128,20,92,16,"socket"],[128,26,92,22],[128,28,92,24,"connected"],[128,37,92,33],[128,41,92,37],[128,46,92,42],[129,6,93,2],[130,4,93,3],[131,2,93,3],[132,2,96,7],[132,6,96,13,"socketService"],[132,19,96,26],[132,22,96,29],[132,26,96,33,"SocketService"],[132,39,96,46],[132,40,96,47],[132,41,96,48],[133,0,96,49],[133,3]],"functionMap":{"names":["<global>","SocketService","SocketService#connect","on$argument_1","SocketService#disconnect","SocketService#joinCommunity","SocketService#sendMessage","SocketService#onNewMessage","<anonymous>","SocketService#onUserJoined","SocketService#emitTyping","SocketService#isConnected"],"mappings":"AAA;ACK;ECI;8BCgB;KDG;oCCE;KDE;oCCE;KDE;iCCE;KDE;GDC;EGE;GHM;EIE;GJG;EKE;GLG;EME;6BCC,QD;WCU;KDE;GNC;EQE;6BDC,QC;WDE;KCE;GRC;ESE;GTG;EUE;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}