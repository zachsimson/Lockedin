{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"],"imports":1}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":49,"index":96}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersClassCallCheck = require(_dependencyMap[1], \"@babel/runtime/helpers/classCallCheck\");\n  var _classCallCheck = _interopDefault(_babelRuntimeHelpersClassCallCheck);\n  var _babelRuntimeHelpersCreateClass = require(_dependencyMap[2], \"@babel/runtime/helpers/createClass\");\n  var _createClass = _interopDefault(_babelRuntimeHelpersCreateClass);\n  var _expoVirtualEnv = require(_dependencyMap[3], \"expo/virtual/env\");\n  var _socketIoClient = require(_dependencyMap[4], \"socket.io-client\");\n  var _expoSecureStore = require(_dependencyMap[5], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var SOCKET_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n  var SocketService = /*#__PURE__*/function () {\n    function SocketService() {\n      (0, _classCallCheck.default)(this, SocketService);\n      this.socket = null;\n      this.listeners = new Map();\n    }\n    return (0, _createClass.default)(SocketService, [{\n      key: \"connect\",\n      value: function () {\n        var _connect = (0, _asyncToGenerator.default)(function* () {\n          if (this.socket?.connected) return;\n          var token = yield SecureStore.getItemAsync('authToken');\n          if (!token) {\n            console.log('No auth token found');\n            return;\n          }\n          this.socket = (0, _socketIoClient.io)(SOCKET_URL, {\n            transports: ['websocket', 'polling'],\n            reconnection: true,\n            reconnectionDelay: 1000,\n            reconnectionAttempts: 5\n          });\n          this.socket.on('connect', () => {\n            console.log('Socket connected');\n            this.socket?.emit('authenticate', {\n              token\n            });\n          });\n          this.socket.on('authenticated', data => {\n            console.log('Socket authenticated:', data);\n          });\n          this.socket.on('connect_error', error => {\n            console.error('Socket connection error:', error);\n          });\n          this.socket.on('disconnect', () => {\n            console.log('Socket disconnected');\n          });\n        });\n        function connect() {\n          return _connect.apply(this, arguments);\n        }\n        return connect;\n      }()\n    }, {\n      key: \"disconnect\",\n      value: function disconnect() {\n        if (this.socket) {\n          this.socket.disconnect();\n          this.socket = null;\n          this.listeners.clear();\n        }\n      }\n    }, {\n      key: \"joinCommunity\",\n      value: function joinCommunity() {\n        if (!this.socket) return;\n        this.socket.emit('join_community', {});\n      }\n    }, {\n      key: \"sendMessage\",\n      value: function sendMessage(message) {\n        if (!this.socket) return;\n        this.socket.emit('send_message', {\n          message\n        });\n      }\n    }, {\n      key: \"onNewMessage\",\n      value: function onNewMessage(callback) {\n        if (!this.socket) return () => {};\n        this.socket.on('new_message', callback);\n\n        // Store listener for cleanup\n        if (!this.listeners.has('new_message')) {\n          this.listeners.set('new_message', []);\n        }\n        this.listeners.get('new_message')?.push(callback);\n        return () => {\n          this.socket?.off('new_message', callback);\n        };\n      }\n    }, {\n      key: \"onUserJoined\",\n      value: function onUserJoined(callback) {\n        if (!this.socket) return () => {};\n        this.socket.on('user_joined', callback);\n        return () => {\n          this.socket?.off('user_joined', callback);\n        };\n      }\n    }, {\n      key: \"emitTyping\",\n      value: function emitTyping() {\n        if (!this.socket) return;\n        this.socket.emit('typing', {});\n      }\n    }, {\n      key: \"isConnected\",\n      value: function isConnected() {\n        return this.socket?.connected || false;\n      }\n    }]);\n  }();\n  var socketService = new SocketService();\n});","lineCount":148,"map":[[27,2,96,0,"Object"],[27,8,96,0],[27,9,96,0,"defineProperty"],[27,23,96,0],[27,24,96,0,"exports"],[27,31,96,0],[28,4,96,0,"enumerable"],[28,14,96,0],[29,4,96,0,"get"],[29,7,96,0],[29,18,96,0,"get"],[29,19,96,0],[30,6,96,0],[30,13,96,0,"socketService"],[30,26,96,0],[31,4,96,0],[32,2,96,0],[33,2,96,49],[33,6,96,49,"_babelRuntimeHelpersAsyncToGenerator"],[33,42,96,49],[33,45,96,49,"require"],[33,52,96,49],[33,53,96,49,"_dependencyMap"],[33,67,96,49],[34,2,96,49],[34,6,96,49,"_asyncToGenerator"],[34,23,96,49],[34,26,96,49,"_interopDefault"],[34,41,96,49],[34,42,96,49,"_babelRuntimeHelpersAsyncToGenerator"],[34,78,96,49],[35,2,96,49],[35,6,96,49,"_babelRuntimeHelpersClassCallCheck"],[35,40,96,49],[35,43,96,49,"require"],[35,50,96,49],[35,51,96,49,"_dependencyMap"],[35,65,96,49],[36,2,96,49],[36,6,96,49,"_classCallCheck"],[36,21,96,49],[36,24,96,49,"_interopDefault"],[36,39,96,49],[36,40,96,49,"_babelRuntimeHelpersClassCallCheck"],[36,74,96,49],[37,2,96,49],[37,6,96,49,"_babelRuntimeHelpersCreateClass"],[37,37,96,49],[37,40,96,49,"require"],[37,47,96,49],[37,48,96,49,"_dependencyMap"],[37,62,96,49],[38,2,96,49],[38,6,96,49,"_createClass"],[38,18,96,49],[38,21,96,49,"_interopDefault"],[38,36,96,49],[38,37,96,49,"_babelRuntimeHelpersCreateClass"],[38,68,96,49],[39,2,96,49],[39,6,96,49,"_expoVirtualEnv"],[39,21,96,49],[39,24,96,49,"require"],[39,31,96,49],[39,32,96,49,"_dependencyMap"],[39,46,96,49],[40,2,1,0],[40,6,1,0,"_socketIoClient"],[40,21,1,0],[40,24,1,0,"require"],[40,31,1,0],[40,32,1,0,"_dependencyMap"],[40,46,1,0],[41,2,2,0],[41,6,2,0,"_expoSecureStore"],[41,22,2,0],[41,25,2,0,"require"],[41,32,2,0],[41,33,2,0,"_dependencyMap"],[41,47,2,0],[42,2,2,0],[42,6,2,0,"SecureStore"],[42,17,2,0],[42,20,2,0,"_interopNamespace"],[42,37,2,0],[42,38,2,0,"_expoSecureStore"],[42,54,2,0],[43,2,4,0],[43,6,4,6,"SOCKET_URL"],[43,16,4,16],[43,19,4,19,"_expoVirtualEnv"],[43,34,4,19],[43,35,4,19,"env"],[43,38,4,19],[43,39,4,19,"EXPO_PUBLIC_BACKEND_URL"],[43,62,4,19],[43,66,4,58],[43,89,4,81],[44,2,4,82],[44,6,6,6,"SocketService"],[44,19,6,19],[45,4,6,19],[45,13,6,19,"SocketService"],[45,27,6,19],[46,6,6,19],[46,10,6,19,"_classCallCheck"],[46,25,6,19],[46,26,6,19,"default"],[46,33,6,19],[46,41,6,19,"SocketService"],[46,54,6,19],[47,6,6,19],[47,11,7,10,"socket"],[47,17,7,16],[47,20,7,34],[47,24,7,38],[48,6,7,38],[48,11,8,10,"listeners"],[48,20,8,19],[48,23,8,47],[48,27,8,51,"Map"],[48,30,8,54],[48,31,8,55],[48,32,8,56],[49,4,8,56],[50,4,8,56],[50,15,8,56,"_createClass"],[50,27,8,56],[50,28,8,56,"default"],[50,35,8,56],[50,37,8,56,"SocketService"],[50,50,8,56],[51,6,8,56,"key"],[51,9,8,56],[52,6,8,56,"value"],[52,11,8,56],[53,8,8,56],[53,12,8,56,"_connect"],[53,20,8,56],[53,27,8,56,"_asyncToGenerator"],[53,44,8,56],[53,45,8,56,"default"],[53,52,8,56],[53,54,10,2],[53,67,10,18],[54,10,11,4],[54,14,11,8],[54,18,11,12],[54,19,11,13,"socket"],[54,25,11,19],[54,27,11,21,"connected"],[54,36,11,30],[54,38,11,32],[55,10,13,4],[55,14,13,10,"token"],[55,19,13,15],[55,28,13,24,"SecureStore"],[55,39,13,35],[55,40,13,36,"getItemAsync"],[55,52,13,48],[55,53,13,49],[55,64,13,60],[55,65,13,61],[56,10,14,4],[56,14,14,8],[56,15,14,9,"token"],[56,20,14,14],[56,22,14,16],[57,12,15,6,"console"],[57,19,15,13],[57,20,15,14,"log"],[57,23,15,17],[57,24,15,18],[57,45,15,39],[57,46,15,40],[58,12,16,6],[59,10,17,4],[60,10,19,4],[60,14,19,8],[60,15,19,9,"socket"],[60,21,19,15],[60,24,19,18],[60,28,19,18,"io"],[60,43,19,20],[60,44,19,20,"io"],[60,46,19,20],[60,48,19,21,"SOCKET_URL"],[60,58,19,31],[60,60,19,33],[61,12,20,6,"transports"],[61,22,20,16],[61,24,20,18],[61,25,20,19],[61,36,20,30],[61,38,20,32],[61,47,20,41],[61,48,20,42],[62,12,21,6,"reconnection"],[62,24,21,18],[62,26,21,20],[62,30,21,24],[63,12,22,6,"reconnectionDelay"],[63,29,22,23],[63,31,22,25],[63,35,22,29],[64,12,23,6,"reconnectionAttempts"],[64,32,23,26],[64,34,23,28],[65,10,24,4],[65,11,24,5],[65,12,24,6],[66,10,26,4],[66,14,26,8],[66,15,26,9,"socket"],[66,21,26,15],[66,22,26,16,"on"],[66,24,26,18],[66,25,26,19],[66,34,26,28],[66,36,26,30],[66,42,26,36],[67,12,27,6,"console"],[67,19,27,13],[67,20,27,14,"log"],[67,23,27,17],[67,24,27,18],[67,42,27,36],[67,43,27,37],[68,12,28,6],[68,16,28,10],[68,17,28,11,"socket"],[68,23,28,17],[68,25,28,19,"emit"],[68,29,28,23],[68,30,28,24],[68,44,28,38],[68,46,28,40],[69,14,28,42,"token"],[70,12,28,48],[70,13,28,49],[70,14,28,50],[71,10,29,4],[71,11,29,5],[71,12,29,6],[72,10,31,4],[72,14,31,8],[72,15,31,9,"socket"],[72,21,31,15],[72,22,31,16,"on"],[72,24,31,18],[72,25,31,19],[72,40,31,34],[72,42,31,37,"data"],[72,46,31,41],[72,50,31,46],[73,12,32,6,"console"],[73,19,32,13],[73,20,32,14,"log"],[73,23,32,17],[73,24,32,18],[73,47,32,41],[73,49,32,43,"data"],[73,53,32,47],[73,54,32,48],[74,10,33,4],[74,11,33,5],[74,12,33,6],[75,10,35,4],[75,14,35,8],[75,15,35,9,"socket"],[75,21,35,15],[75,22,35,16,"on"],[75,24,35,18],[75,25,35,19],[75,40,35,34],[75,42,35,37,"error"],[75,47,35,42],[75,51,35,47],[76,12,36,6,"console"],[76,19,36,13],[76,20,36,14,"error"],[76,25,36,19],[76,26,36,20],[76,52,36,46],[76,54,36,48,"error"],[76,59,36,53],[76,60,36,54],[77,10,37,4],[77,11,37,5],[77,12,37,6],[78,10,39,4],[78,14,39,8],[78,15,39,9,"socket"],[78,21,39,15],[78,22,39,16,"on"],[78,24,39,18],[78,25,39,19],[78,37,39,31],[78,39,39,33],[78,45,39,39],[79,12,40,6,"console"],[79,19,40,13],[79,20,40,14,"log"],[79,23,40,17],[79,24,40,18],[79,45,40,39],[79,46,40,40],[80,10,41,4],[80,11,41,5],[80,12,41,6],[81,8,42,2],[81,9,42,3],[82,8,42,3],[82,17,10,8,"connect"],[82,24,10,15,"connect"],[82,25,10,15],[83,10,10,15],[83,17,10,15,"_connect"],[83,25,10,15],[83,26,10,15,"apply"],[83,31,10,15],[83,38,10,15,"arguments"],[83,47,10,15],[84,8,10,15],[85,8,10,15],[85,15,10,8,"connect"],[85,22,10,15],[86,6,10,15],[87,4,10,15],[88,6,10,15,"key"],[88,9,10,15],[89,6,10,15,"value"],[89,11,10,15],[89,13,44,2],[89,22,44,2,"disconnect"],[89,32,44,12,"disconnect"],[89,33,44,12],[89,35,44,15],[90,8,45,4],[90,12,45,8],[90,16,45,12],[90,17,45,13,"socket"],[90,23,45,19],[90,25,45,21],[91,10,46,6],[91,14,46,10],[91,15,46,11,"socket"],[91,21,46,17],[91,22,46,18,"disconnect"],[91,32,46,28],[91,33,46,29],[91,34,46,30],[92,10,47,6],[92,14,47,10],[92,15,47,11,"socket"],[92,21,47,17],[92,24,47,20],[92,28,47,24],[93,10,48,6],[93,14,48,10],[93,15,48,11,"listeners"],[93,24,48,20],[93,25,48,21,"clear"],[93,30,48,26],[93,31,48,27],[93,32,48,28],[94,8,49,4],[95,6,50,2],[96,4,50,3],[97,6,50,3,"key"],[97,9,50,3],[98,6,50,3,"value"],[98,11,50,3],[98,13,52,2],[98,22,52,2,"joinCommunity"],[98,35,52,15,"joinCommunity"],[98,36,52,15],[98,38,52,18],[99,8,53,4],[99,12,53,8],[99,13,53,9],[99,17,53,13],[99,18,53,14,"socket"],[99,24,53,20],[99,26,53,22],[100,8,54,4],[100,12,54,8],[100,13,54,9,"socket"],[100,19,54,15],[100,20,54,16,"emit"],[100,24,54,20],[100,25,54,21],[100,41,54,37],[100,43,54,39],[100,44,54,40],[100,45,54,41],[100,46,54,42],[101,6,55,2],[102,4,55,3],[103,6,55,3,"key"],[103,9,55,3],[104,6,55,3,"value"],[104,11,55,3],[104,13,57,2],[104,22,57,2,"sendMessage"],[104,33,57,13,"sendMessage"],[104,34,57,14,"message"],[104,41,57,29],[104,43,57,31],[105,8,58,4],[105,12,58,8],[105,13,58,9],[105,17,58,13],[105,18,58,14,"socket"],[105,24,58,20],[105,26,58,22],[106,8,59,4],[106,12,59,8],[106,13,59,9,"socket"],[106,19,59,15],[106,20,59,16,"emit"],[106,24,59,20],[106,25,59,21],[106,39,59,35],[106,41,59,37],[107,10,59,39,"message"],[108,8,59,47],[108,9,59,48],[108,10,59,49],[109,6,60,2],[110,4,60,3],[111,6,60,3,"key"],[111,9,60,3],[112,6,60,3,"value"],[112,11,60,3],[112,13,62,2],[112,22,62,2,"onNewMessage"],[112,34,62,14,"onNewMessage"],[112,35,62,15,"callback"],[112,43,62,44],[112,45,62,46],[113,8,63,4],[113,12,63,8],[113,13,63,9],[113,17,63,13],[113,18,63,14,"socket"],[113,24,63,20],[113,26,63,22],[113,33,63,29],[113,39,63,35],[113,40,63,36],[113,41,63,37],[114,8,65,4],[114,12,65,8],[114,13,65,9,"socket"],[114,19,65,15],[114,20,65,16,"on"],[114,22,65,18],[114,23,65,19],[114,36,65,32],[114,38,65,34,"callback"],[114,46,65,42],[114,47,65,43],[116,8,67,4],[117,8,68,4],[117,12,68,8],[117,13,68,9],[117,17,68,13],[117,18,68,14,"listeners"],[117,27,68,23],[117,28,68,24,"has"],[117,31,68,27],[117,32,68,28],[117,45,68,41],[117,46,68,42],[117,48,68,44],[118,10,69,6],[118,14,69,10],[118,15,69,11,"listeners"],[118,24,69,20],[118,25,69,21,"set"],[118,28,69,24],[118,29,69,25],[118,42,69,38],[118,44,69,40],[118,46,69,42],[118,47,69,43],[119,8,70,4],[120,8,71,4],[120,12,71,8],[120,13,71,9,"listeners"],[120,22,71,18],[120,23,71,19,"get"],[120,26,71,22],[120,27,71,23],[120,40,71,36],[120,41,71,37],[120,43,71,39,"push"],[120,47,71,43],[120,48,71,44,"callback"],[120,56,71,52],[120,57,71,53],[121,8,73,4],[121,15,73,11],[121,21,73,17],[122,10,74,6],[122,14,74,10],[122,15,74,11,"socket"],[122,21,74,17],[122,23,74,19,"off"],[122,26,74,22],[122,27,74,23],[122,40,74,36],[122,42,74,38,"callback"],[122,50,74,46],[122,51,74,47],[123,8,75,4],[123,9,75,5],[124,6,76,2],[125,4,76,3],[126,6,76,3,"key"],[126,9,76,3],[127,6,76,3,"value"],[127,11,76,3],[127,13,78,2],[127,22,78,2,"onUserJoined"],[127,34,78,14,"onUserJoined"],[127,35,78,15,"callback"],[127,43,78,44],[127,45,78,46],[128,8,79,4],[128,12,79,8],[128,13,79,9],[128,17,79,13],[128,18,79,14,"socket"],[128,24,79,20],[128,26,79,22],[128,33,79,29],[128,39,79,35],[128,40,79,36],[128,41,79,37],[129,8,80,4],[129,12,80,8],[129,13,80,9,"socket"],[129,19,80,15],[129,20,80,16,"on"],[129,22,80,18],[129,23,80,19],[129,36,80,32],[129,38,80,34,"callback"],[129,46,80,42],[129,47,80,43],[130,8,81,4],[130,15,81,11],[130,21,81,17],[131,10,82,6],[131,14,82,10],[131,15,82,11,"socket"],[131,21,82,17],[131,23,82,19,"off"],[131,26,82,22],[131,27,82,23],[131,40,82,36],[131,42,82,38,"callback"],[131,50,82,46],[131,51,82,47],[132,8,83,4],[132,9,83,5],[133,6,84,2],[134,4,84,3],[135,6,84,3,"key"],[135,9,84,3],[136,6,84,3,"value"],[136,11,84,3],[136,13,86,2],[136,22,86,2,"emitTyping"],[136,32,86,12,"emitTyping"],[136,33,86,12],[136,35,86,15],[137,8,87,4],[137,12,87,8],[137,13,87,9],[137,17,87,13],[137,18,87,14,"socket"],[137,24,87,20],[137,26,87,22],[138,8,88,4],[138,12,88,8],[138,13,88,9,"socket"],[138,19,88,15],[138,20,88,16,"emit"],[138,24,88,20],[138,25,88,21],[138,33,88,29],[138,35,88,31],[138,36,88,32],[138,37,88,33],[138,38,88,34],[139,6,89,2],[140,4,89,3],[141,6,89,3,"key"],[141,9,89,3],[142,6,89,3,"value"],[142,11,89,3],[142,13,91,2],[142,22,91,2,"isConnected"],[142,33,91,13,"isConnected"],[142,34,91,13],[142,36,91,25],[143,8,92,4],[143,15,92,11],[143,19,92,15],[143,20,92,16,"socket"],[143,26,92,22],[143,28,92,24,"connected"],[143,37,92,33],[143,41,92,37],[143,46,92,42],[144,6,93,2],[145,4,93,3],[146,2,93,3],[147,2,96,7],[147,6,96,13,"socketService"],[147,19,96,26],[147,22,96,29],[147,26,96,33,"SocketService"],[147,39,96,46],[147,40,96,47],[147,41,96,48],[148,0,96,49],[148,3]],"functionMap":{"names":["<global>","SocketService","SocketService#connect","on$argument_1","SocketService#disconnect","SocketService#joinCommunity","SocketService#sendMessage","SocketService#onNewMessage","<anonymous>","SocketService#onUserJoined","SocketService#emitTyping","SocketService#isConnected"],"mappings":"AAA;ACK;ECI;8BCgB;KDG;oCCE;KDE;oCCE;KDE;iCCE;KDE;GDC;EGE;GHM;EIE;GJG;EKE;GLG;EME;6BCC,QD;WCU;KDE;GNC;EQE;6BDC,QC;WDE;KCE;GRC;ESE;GTG;EUE;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}