{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}},{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":32,"index":79}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _socketIoClient = require(_dependencyMap[1], \"socket.io-client\");\n  var _storage = require(_dependencyMap[2], \"./storage\");\n  var storage = _interopDefault(_storage);\n  const SOCKET_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || '/api';\n  class SocketService {\n    socket = null;\n    listeners = new Map();\n    async connect() {\n      if (this.socket?.connected) return;\n      const token = await storage.default.getItem('authToken');\n      if (!token) {\n        console.log('No auth token found');\n        return;\n      }\n      this.socket = (0, _socketIoClient.io)(SOCKET_URL, {\n        transports: ['websocket', 'polling'],\n        reconnection: true,\n        reconnectionDelay: 1000,\n        reconnectionAttempts: 5\n      });\n      this.socket.on('connect', () => {\n        console.log('Socket connected');\n        this.socket?.emit('authenticate', {\n          token\n        });\n      });\n      this.socket.on('authenticated', data => {\n        console.log('Socket authenticated:', data);\n      });\n      this.socket.on('connect_error', error => {\n        console.error('Socket connection error:', error);\n      });\n      this.socket.on('disconnect', () => {\n        console.log('Socket disconnected');\n      });\n    }\n    disconnect() {\n      if (this.socket) {\n        this.socket.disconnect();\n        this.socket = null;\n        this.listeners.clear();\n      }\n    }\n    joinCommunity() {\n      if (!this.socket) return;\n      this.socket.emit('join_community', {});\n    }\n    sendMessage(message) {\n      if (!this.socket) return;\n      this.socket.emit('send_message', {\n        message\n      });\n    }\n    onNewMessage(callback) {\n      if (!this.socket) return () => {};\n      this.socket.on('new_message', callback);\n\n      // Store listener for cleanup\n      if (!this.listeners.has('new_message')) {\n        this.listeners.set('new_message', []);\n      }\n      this.listeners.get('new_message')?.push(callback);\n      return () => {\n        this.socket?.off('new_message', callback);\n      };\n    }\n    onUserJoined(callback) {\n      if (!this.socket) return () => {};\n      this.socket.on('user_joined', callback);\n      return () => {\n        this.socket?.off('user_joined', callback);\n      };\n    }\n    emitTyping() {\n      if (!this.socket) return;\n      this.socket.emit('typing', {});\n    }\n    isConnected() {\n      return this.socket?.connected || false;\n    }\n  }\n  const socketService = new SocketService();\n});","lineCount":101,"map":[[12,2,96,0,"Object"],[12,8,96,0],[12,9,96,0,"defineProperty"],[12,23,96,0],[12,24,96,0,"exports"],[12,31,96,0],[13,4,96,0,"enumerable"],[13,14,96,0],[14,4,96,0,"get"],[14,7,96,0],[14,18,96,0,"get"],[14,19,96,0],[15,6,96,0],[15,13,96,0,"socketService"],[15,26,96,0],[16,4,96,0],[17,2,96,0],[18,2,96,49],[18,6,96,49,"_expoVirtualEnv"],[18,21,96,49],[18,24,96,49,"require"],[18,31,96,49],[18,32,96,49,"_dependencyMap"],[18,46,96,49],[19,2,1,0],[19,6,1,0,"_socketIoClient"],[19,21,1,0],[19,24,1,0,"require"],[19,31,1,0],[19,32,1,0,"_dependencyMap"],[19,46,1,0],[20,2,2,0],[20,6,2,0,"_storage"],[20,14,2,0],[20,17,2,0,"require"],[20,24,2,0],[20,25,2,0,"_dependencyMap"],[20,39,2,0],[21,2,2,0],[21,6,2,0,"storage"],[21,13,2,0],[21,16,2,0,"_interopDefault"],[21,31,2,0],[21,32,2,0,"_storage"],[21,40,2,0],[22,2,4,0],[22,8,4,6,"SOCKET_URL"],[22,18,4,16],[22,21,4,19,"_expoVirtualEnv"],[22,36,4,19],[22,37,4,19,"env"],[22,40,4,19],[22,41,4,19,"EXPO_PUBLIC_BACKEND_URL"],[22,64,4,19],[22,68,4,58],[22,74,4,64],[23,2,6,0],[23,8,6,6,"SocketService"],[23,21,6,19],[23,22,6,20],[24,4,7,10,"socket"],[24,10,7,16],[24,13,7,34],[24,17,7,38],[25,4,8,10,"listeners"],[25,13,8,19],[25,16,8,47],[25,20,8,51,"Map"],[25,23,8,54],[25,24,8,55],[25,25,8,56],[26,4,10,2],[26,10,10,8,"connect"],[26,17,10,15,"connect"],[26,18,10,15],[26,20,10,18],[27,6,11,4],[27,10,11,8],[27,14,11,12],[27,15,11,13,"socket"],[27,21,11,19],[27,23,11,21,"connected"],[27,32,11,30],[27,34,11,32],[28,6,13,4],[28,12,13,10,"token"],[28,17,13,15],[28,20,13,18],[28,26,13,24,"storage"],[28,33,13,31],[28,34,13,31,"default"],[28,41,13,31],[28,42,13,32,"getItem"],[28,49,13,39],[28,50,13,40],[28,61,13,51],[28,62,13,52],[29,6,14,4],[29,10,14,8],[29,11,14,9,"token"],[29,16,14,14],[29,18,14,16],[30,8,15,6,"console"],[30,15,15,13],[30,16,15,14,"log"],[30,19,15,17],[30,20,15,18],[30,41,15,39],[30,42,15,40],[31,8,16,6],[32,6,17,4],[33,6,19,4],[33,10,19,8],[33,11,19,9,"socket"],[33,17,19,15],[33,20,19,18],[33,24,19,18,"io"],[33,39,19,20],[33,40,19,20,"io"],[33,42,19,20],[33,44,19,21,"SOCKET_URL"],[33,54,19,31],[33,56,19,33],[34,8,20,6,"transports"],[34,18,20,16],[34,20,20,18],[34,21,20,19],[34,32,20,30],[34,34,20,32],[34,43,20,41],[34,44,20,42],[35,8,21,6,"reconnection"],[35,20,21,18],[35,22,21,20],[35,26,21,24],[36,8,22,6,"reconnectionDelay"],[36,25,22,23],[36,27,22,25],[36,31,22,29],[37,8,23,6,"reconnectionAttempts"],[37,28,23,26],[37,30,23,28],[38,6,24,4],[38,7,24,5],[38,8,24,6],[39,6,26,4],[39,10,26,8],[39,11,26,9,"socket"],[39,17,26,15],[39,18,26,16,"on"],[39,20,26,18],[39,21,26,19],[39,30,26,28],[39,32,26,30],[39,38,26,36],[40,8,27,6,"console"],[40,15,27,13],[40,16,27,14,"log"],[40,19,27,17],[40,20,27,18],[40,38,27,36],[40,39,27,37],[41,8,28,6],[41,12,28,10],[41,13,28,11,"socket"],[41,19,28,17],[41,21,28,19,"emit"],[41,25,28,23],[41,26,28,24],[41,40,28,38],[41,42,28,40],[42,10,28,42,"token"],[43,8,28,48],[43,9,28,49],[43,10,28,50],[44,6,29,4],[44,7,29,5],[44,8,29,6],[45,6,31,4],[45,10,31,8],[45,11,31,9,"socket"],[45,17,31,15],[45,18,31,16,"on"],[45,20,31,18],[45,21,31,19],[45,36,31,34],[45,38,31,37,"data"],[45,42,31,41],[45,46,31,46],[46,8,32,6,"console"],[46,15,32,13],[46,16,32,14,"log"],[46,19,32,17],[46,20,32,18],[46,43,32,41],[46,45,32,43,"data"],[46,49,32,47],[46,50,32,48],[47,6,33,4],[47,7,33,5],[47,8,33,6],[48,6,35,4],[48,10,35,8],[48,11,35,9,"socket"],[48,17,35,15],[48,18,35,16,"on"],[48,20,35,18],[48,21,35,19],[48,36,35,34],[48,38,35,37,"error"],[48,43,35,42],[48,47,35,47],[49,8,36,6,"console"],[49,15,36,13],[49,16,36,14,"error"],[49,21,36,19],[49,22,36,20],[49,48,36,46],[49,50,36,48,"error"],[49,55,36,53],[49,56,36,54],[50,6,37,4],[50,7,37,5],[50,8,37,6],[51,6,39,4],[51,10,39,8],[51,11,39,9,"socket"],[51,17,39,15],[51,18,39,16,"on"],[51,20,39,18],[51,21,39,19],[51,33,39,31],[51,35,39,33],[51,41,39,39],[52,8,40,6,"console"],[52,15,40,13],[52,16,40,14,"log"],[52,19,40,17],[52,20,40,18],[52,41,40,39],[52,42,40,40],[53,6,41,4],[53,7,41,5],[53,8,41,6],[54,4,42,2],[55,4,44,2,"disconnect"],[55,14,44,12,"disconnect"],[55,15,44,12],[55,17,44,15],[56,6,45,4],[56,10,45,8],[56,14,45,12],[56,15,45,13,"socket"],[56,21,45,19],[56,23,45,21],[57,8,46,6],[57,12,46,10],[57,13,46,11,"socket"],[57,19,46,17],[57,20,46,18,"disconnect"],[57,30,46,28],[57,31,46,29],[57,32,46,30],[58,8,47,6],[58,12,47,10],[58,13,47,11,"socket"],[58,19,47,17],[58,22,47,20],[58,26,47,24],[59,8,48,6],[59,12,48,10],[59,13,48,11,"listeners"],[59,22,48,20],[59,23,48,21,"clear"],[59,28,48,26],[59,29,48,27],[59,30,48,28],[60,6,49,4],[61,4,50,2],[62,4,52,2,"joinCommunity"],[62,17,52,15,"joinCommunity"],[62,18,52,15],[62,20,52,18],[63,6,53,4],[63,10,53,8],[63,11,53,9],[63,15,53,13],[63,16,53,14,"socket"],[63,22,53,20],[63,24,53,22],[64,6,54,4],[64,10,54,8],[64,11,54,9,"socket"],[64,17,54,15],[64,18,54,16,"emit"],[64,22,54,20],[64,23,54,21],[64,39,54,37],[64,41,54,39],[64,42,54,40],[64,43,54,41],[64,44,54,42],[65,4,55,2],[66,4,57,2,"sendMessage"],[66,15,57,13,"sendMessage"],[66,16,57,14,"message"],[66,23,57,29],[66,25,57,31],[67,6,58,4],[67,10,58,8],[67,11,58,9],[67,15,58,13],[67,16,58,14,"socket"],[67,22,58,20],[67,24,58,22],[68,6,59,4],[68,10,59,8],[68,11,59,9,"socket"],[68,17,59,15],[68,18,59,16,"emit"],[68,22,59,20],[68,23,59,21],[68,37,59,35],[68,39,59,37],[69,8,59,39,"message"],[70,6,59,47],[70,7,59,48],[70,8,59,49],[71,4,60,2],[72,4,62,2,"onNewMessage"],[72,16,62,14,"onNewMessage"],[72,17,62,15,"callback"],[72,25,62,44],[72,27,62,46],[73,6,63,4],[73,10,63,8],[73,11,63,9],[73,15,63,13],[73,16,63,14,"socket"],[73,22,63,20],[73,24,63,22],[73,31,63,29],[73,37,63,35],[73,38,63,36],[73,39,63,37],[74,6,65,4],[74,10,65,8],[74,11,65,9,"socket"],[74,17,65,15],[74,18,65,16,"on"],[74,20,65,18],[74,21,65,19],[74,34,65,32],[74,36,65,34,"callback"],[74,44,65,42],[74,45,65,43],[76,6,67,4],[77,6,68,4],[77,10,68,8],[77,11,68,9],[77,15,68,13],[77,16,68,14,"listeners"],[77,25,68,23],[77,26,68,24,"has"],[77,29,68,27],[77,30,68,28],[77,43,68,41],[77,44,68,42],[77,46,68,44],[78,8,69,6],[78,12,69,10],[78,13,69,11,"listeners"],[78,22,69,20],[78,23,69,21,"set"],[78,26,69,24],[78,27,69,25],[78,40,69,38],[78,42,69,40],[78,44,69,42],[78,45,69,43],[79,6,70,4],[80,6,71,4],[80,10,71,8],[80,11,71,9,"listeners"],[80,20,71,18],[80,21,71,19,"get"],[80,24,71,22],[80,25,71,23],[80,38,71,36],[80,39,71,37],[80,41,71,39,"push"],[80,45,71,43],[80,46,71,44,"callback"],[80,54,71,52],[80,55,71,53],[81,6,73,4],[81,13,73,11],[81,19,73,17],[82,8,74,6],[82,12,74,10],[82,13,74,11,"socket"],[82,19,74,17],[82,21,74,19,"off"],[82,24,74,22],[82,25,74,23],[82,38,74,36],[82,40,74,38,"callback"],[82,48,74,46],[82,49,74,47],[83,6,75,4],[83,7,75,5],[84,4,76,2],[85,4,78,2,"onUserJoined"],[85,16,78,14,"onUserJoined"],[85,17,78,15,"callback"],[85,25,78,44],[85,27,78,46],[86,6,79,4],[86,10,79,8],[86,11,79,9],[86,15,79,13],[86,16,79,14,"socket"],[86,22,79,20],[86,24,79,22],[86,31,79,29],[86,37,79,35],[86,38,79,36],[86,39,79,37],[87,6,80,4],[87,10,80,8],[87,11,80,9,"socket"],[87,17,80,15],[87,18,80,16,"on"],[87,20,80,18],[87,21,80,19],[87,34,80,32],[87,36,80,34,"callback"],[87,44,80,42],[87,45,80,43],[88,6,81,4],[88,13,81,11],[88,19,81,17],[89,8,82,6],[89,12,82,10],[89,13,82,11,"socket"],[89,19,82,17],[89,21,82,19,"off"],[89,24,82,22],[89,25,82,23],[89,38,82,36],[89,40,82,38,"callback"],[89,48,82,46],[89,49,82,47],[90,6,83,4],[90,7,83,5],[91,4,84,2],[92,4,86,2,"emitTyping"],[92,14,86,12,"emitTyping"],[92,15,86,12],[92,17,86,15],[93,6,87,4],[93,10,87,8],[93,11,87,9],[93,15,87,13],[93,16,87,14,"socket"],[93,22,87,20],[93,24,87,22],[94,6,88,4],[94,10,88,8],[94,11,88,9,"socket"],[94,17,88,15],[94,18,88,16,"emit"],[94,22,88,20],[94,23,88,21],[94,31,88,29],[94,33,88,31],[94,34,88,32],[94,35,88,33],[94,36,88,34],[95,4,89,2],[96,4,91,2,"isConnected"],[96,15,91,13,"isConnected"],[96,16,91,13],[96,18,91,25],[97,6,92,4],[97,13,92,11],[97,17,92,15],[97,18,92,16,"socket"],[97,24,92,22],[97,26,92,24,"connected"],[97,35,92,33],[97,39,92,37],[97,44,92,42],[98,4,93,2],[99,2,94,0],[100,2,96,7],[100,8,96,13,"socketService"],[100,21,96,26],[100,24,96,29],[100,28,96,33,"SocketService"],[100,41,96,46],[100,42,96,47],[100,43,96,48],[101,0,96,49],[101,3]],"functionMap":{"names":["<global>","SocketService","SocketService#connect","on$argument_1","SocketService#disconnect","SocketService#joinCommunity","SocketService#sendMessage","SocketService#onNewMessage","<anonymous>","SocketService#onUserJoined","SocketService#emitTyping","SocketService#isConnected"],"mappings":"AAA;ACK;ECI;8BCgB;KDG;oCCE;KDE;oCCE;KDE;iCCE;KDE;GDC;EGE;GHM;EIE;GJG;EKE;GLG;EME;6BCC,QD;WCU;KDE;GNC;EQE;6BDC,QC;WDE;KCE;GRC;ESE;GTG;EUE;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}